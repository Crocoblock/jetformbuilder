(()=>{"use strict";const e=window.React,t=window.wp.element,n=window.wp.components,o=window.jfb.actions,r=window.jfb.components,{ActionFieldsMapContext:l,CurrentPropertyMapContext:a}=JetFBComponents,s="single_value_as_array",i=function(){var i;const{FieldSelect:p,property:c}=(0,t.useContext)(a),{source:u,setMapField:d,getMapField:m}=(0,t.useContext)(o.CurrentActionEditContext),{name:h,index:f}=(0,t.useContext)(l),_=null!==(i=m({name:h}))&&void 0!==i?i:"",y=!!m({source:s,name:h}),E=e=>d({nameField:h,value:e}),g=e=>d({source:s,nameField:h,value:!!e});switch(c){case"meta_input":return(0,e.createElement)("div",{className:"components-base-control jet-margin-bottom-wrapper"},p,(0,e.createElement)(r.StyledTextControl,{key:h+f+"_text",value:_,onChange:E}),(0,e.createElement)(n.ToggleControl,{className:"jet-margin-top-xs",label:"Save single value as array",checked:y,onChange:g}));case"post_terms":return(0,e.createElement)("div",{className:"components-base-control jet-margin-bottom-wrapper"},p,(0,e.createElement)(r.StyledSelectControl,{key:h+f+"_select",value:_,onChange:E,options:u.taxonomies}));default:return p}},p=window.wp.hooks;var c=function(){const e=Array.prototype.slice.call(arguments).filter(Boolean),t={},n=[];e.forEach((e=>{(e?e.split(" "):[]).forEach((e=>{if(e.startsWith("atm_")){const[,n]=e.split("_");t[n]=e}else n.push(e)}))}));const o=[];for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&o.push(t[e]);return o.push(...n),o.join(" ")};const u=window.wp.i18n,d=window.jfb.blocksToActions;class m extends wp.element.Component{constructor(e){super(e),this.addNewOption=this.addNewOption.bind(this)}getDefaultMeta(){return this.props.defaultMeta?Array.from(this.props.defaultMeta):[]}addNewOption(){const e=this.getDefaultMeta();e.push({key:"",value:""}),this.props.onChange(e)}removeOption(e){const t=this.getDefaultMeta();t.splice(e,1),this.props.onChange(t)}onChangeValue({value:e,name:t,id:n}){const o=Array.from(this.props.defaultMeta);o[n][t]=e,this.props.onChange(o)}render(){return(0,e.createElement)(e.Fragment,null,this.getDefaultMeta().map(((t,o)=>(0,e.createElement)("div",{className:"jet-user-meta__row",key:"jet-form-builder-repeater-item-"+o},(0,e.createElement)("div",{className:"repeater-item-column jet-margin-bottom-wrapper"},(0,e.createElement)(r.StyledTextControl,{key:"meta_key",label:(0,u.__)("Meta Key","jet-form-builder"),value:t.key,onChange:e=>{this.onChangeValue({value:e,name:"key",id:o})}}),(0,e.createElement)(r.StyledTextControl,{key:"meta_value",label:(0,u.__)("Meta Value","jet-form-builder"),value:t.value,onChange:e=>{this.onChangeValue({value:e,name:"value",id:o})}})),(0,e.createElement)("div",{className:"repeater-item-column"},(0,e.createElement)(n.Button,{icon:"dismiss",label:"Remove",onClick:()=>this.removeOption(o)}))))),(0,e.createElement)(n.FlexItem,null,(0,e.createElement)(n.Button,{className:"button-add-option",isSecondary:!0,onClick:this.addNewOption},(0,u.__)("Add New Option","jet-form-builder"))))}}const h=m,{convertListToFieldsMap:f}=JetFBActions,{ActionFieldsMap:_,WrapperRequiredControl:y,DynamicPropertySelect:E}=JetFBComponents,g=(0,p.applyFilters)("jet.fb.insert.post.modifiers",[{id:"all",isSupported:()=>!0}]),C=e=>{for(const t of g)if(t.isSupported(e))return t.id},{BaseComputedField:w}=JetFBComponents,{__:v}=wp.i18n;function b(){w.call(this),this.getSupportedActions=function(){return["insert_post"]},this.getName=function(){return"inserted_post_id"},this.getHelp=function(){return v("A computed field from the <b>Insert/Update Post</b> action.","jet-form-builder")}}b.prototype=Object.create(w.prototype);const F=b,S=e=>{const{insert_post:t={}}=e?.settings;return t.post_type};function j(){o.BaseComputedField.call(this),this.getSupportedActions=function(){return["insert_post"]},this.isSupported=function(e){return o.BaseComputedField.prototype.isSupported.call(this,e)&&S(e)},this.getName=function(){const e=this.hasInList?`_${this.action.id}`:"";return`inserted_${S(this.action)}`+e},this.getHelp=function(){return(0,u.sprintf)((0,u.__)("A computed field from the <b>Insert/Update Post (%s)</b> action.","jet-form-builder"),this.action.id)}}j.prototype=Object.create(o.BaseComputedField.prototype);const x=j,{addComputedField:M}=JetFBActions;M(F),M(x);const A={type:"insert_post",label:(0,u.__)("Insert/Update Post","jet-form-builder"),edit:function(l){const{settings:a,onChangeSettingObj:s,source:p,help:m,label:g}=l,w=f((0,d.useFields)()),[v,b]=(0,t.useState)((()=>{var e;const t=C(a);return null!==(e=p.properties[t])&&void 0!==e?e:[]}));return(0,t.useEffect)((()=>{a.requestFields?.length&&s({requestFields:null})}),[]),(0,t.useEffect)((()=>{var e;const t=C(a);b(null!==(e=p.properties[t])&&void 0!==e?e:[])}),[a.post_type]),(0,d.useSanitizeFieldsMap)(),(0,e.createElement)(n.Flex,{direction:"column"},(0,e.createElement)(r.RowControl,null,(({id:t})=>(0,e.createElement)(o.ValidatorProvider,{isSupported:e=>"post_type"===e?.property},(({hasError:n,setShowError:o})=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)(r.RequiredLabel,{htmlFor:t},(0,u.__)("Post type","jet-form-builder")),(0,e.createElement)(r.StyledFlexControl,{className:c(r.RowControlEndStyle,n&&r.ControlWithErrorStyle),direction:"column"},n&&(0,e.createElement)(r.IconText,null,(0,u.__)("Please fill this required field","jet-form-builder")),(0,e.createElement)(r.StyledSelectControl,{id:t,value:a.post_type,options:p.postTypes,help:m("post_type"),onChange:e=>s({post_type:e}),onBlur:()=>o(!0)}))))))),(0,e.createElement)(r.WideLine,null),(0,e.createElement)(r.RowControl,null,(({id:t})=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)(r.Label,{htmlFor:t},g("post_status")),(0,e.createElement)(r.StyledSelectControl,{id:t,value:a.post_status,options:p.postStatuses,help:m("post_status"),onChange:e=>s({post_status:e})})))),(0,e.createElement)(r.WideLine,null),(0,e.createElement)(_,{label:g("fields_map"),fields:w},(0,e.createElement)(y,null,(0,e.createElement)(E,{dynamic:["meta_input","post_terms"],properties:v,parseValue:e=>e.includes("jet_tax__")?"post_terms":"meta_input"},(0,e.createElement)(i,null)))),(0,e.createElement)(r.WideLine,null),(0,e.createElement)(r.RowControl,null,(0,e.createElement)(r.Label,null,g("default_meta")),(0,e.createElement)(r.RowControlEnd,null,(0,e.createElement)(h,{defaultMeta:a.default_meta,onChange:e=>s({default_meta:e})}))))},icon:(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,e.createElement)("rect",{x:"0",fill:"none",width:"20",height:"20"}),(0,e.createElement)("g",null,(0,e.createElement)("path",{d:"M17 7V4h-2V2h-3v1H3v15h11V9h1V7h2zm-1-2v1h-2v2h-1V6h-2V5h2V3h1v2h2z"}))),docHref:"https://jetformbuilder.com/features/insert-update-post/",category:"content",validators:[({settings:e})=>!e?.post_type&&{type:"empty",property:"post_type"}]};(0,o.registerAction)(A)})();