(()=>{"use strict";function e(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,l,o,a,i=[],c=!0,m=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(i.push(n.value),i.length!==t);c=!0);}catch(e){m=!0,l=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(m)throw l}}return i}}(e,r)||function(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var r=wp.components,n=r.Modal,l=r.TextareaControl,o=r.Button,a=wp.element.useState,i=wp.i18n.__,c=wp.apiFetch,m=JetFormBuilderParser,u=m.parseHTMLtoBlocks,p=m.getFormInnerFields,s=["#fake-ai","Registration form with minimum inputs","Opt-in form with gender selector like radio","Quiz form with 5 questions with choices about math"];const f=function(t){var r=t.setShowModal,m=t.footer,f=void 0===m?function(){return"Here may be buttons"}:m,d=e(a(""),2),w=d[0],h=d[1],b=e(a(""),2),y=b[0],L=b[1],v=e(a(!1),2),g=v[0],E=v[1];return wp.element.createElement(n,{style:{width:"60vw"},onRequestClose:function(){return r(!1)},title:i("Generate Form with AI","jet-form-builder")},Boolean(y.length)?wp.element.createElement(React.Fragment,null,wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:y},style:{padding:"2em 1em",backgroundColor:"#f6f7f7",marginBottom:"1em"}}),wp.element.createElement(f,{clearHTML:function(){return L("")},formHTML:y,prompt:w})):wp.element.createElement(React.Fragment,null,wp.element.createElement(l,{label:i("Describe the form you want","jet-form-builder"),value:w,onChange:h,help:i("Prompt example: Simple contact form","jet-form-builder")}),wp.element.createElement(o,{variant:"primary",isBusy:g,disabled:g,onClick:function(){E(!0),c({path:"/jet-form-builder/v1/ai/generate",method:"POST",data:{prompt:w}}).then((function(e){L(p(e.form)),console.group(i("JFB: Parsed blocks from generated HTML","jet-form-builder")),console.log(u(e.form)),console.groupEnd()})).catch((function(e){console.error(e)})).finally((function(){E(!1)}))}},i("Generate","jet-form-builder")),wp.element.createElement("h4",null,i("Tips to write good prompt:","jet-form-builder")),wp.element.createElement("ul",{style:{listStyle:"disc",paddingInlineStart:"1em"}},wp.element.createElement("li",null,i("Start with the main purpose of the form.","jet-form-builder")),wp.element.createElement("li",null,i("If you need some specific fields - describe \nthem also in prompt.","jet-form-builder")),wp.element.createElement("li",null,i("Better to use English language for \nthe prompt - AI understand it better than other","jet-form-builder"))),wp.element.createElement("h4",null,i("Examples of the good prompts:","jet-form-builder")),wp.element.createElement("ul",{style:{listStyle:"disc",paddingInlineStart:"1em"}},s.map((function(e){return wp.element.createElement("li",{key:e},wp.element.createElement(o,{onClick:function(){return h(e)},variant:"link"},e))})))))};function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d.apply(this,arguments)}var w=wp.i18n.__,h=JetFormBuilderParser.parseHTMLtoBlocks,b=wp.components,y=b.Button,L=b.Flex,v=b.Popover,g=JetFBHooks,E=g.useTriggerPopover,j=g.usePattern;const S=function(e){var t=e.clearHTML,r=e.formHTML,n=E(),l=n.showPopover,o=n.setShowPopover,a=n.ref,i=n.popoverProps,c=j({name:"ai"}),m=c.insert,u=c.append,p=c.blocks;return wp.element.createElement(L,{justify:"flex-start"},wp.element.createElement(y,{ref:a,variant:"primary",onClick:function(){return p.length?o((function(e){return!e})):m({blocks:h(r)})}},w("Use this form","jet-form-builder")),wp.element.createElement(y,{variant:"secondary",onClick:t},w("Change generation prompt","jet-form-builder")),l&&wp.element.createElement(v,d({position:"top-start",noArrow:!1},i),wp.element.createElement("div",{style:{padding:"0.5em",width:"max-content"}},wp.element.createElement("span",null,w("I want to","jet-form-builder"))," ",wp.element.createElement(y,{isLink:!0,isDestructive:!0,onClick:function(){return m({blocks:h(r)})}},w("replace","jet-form-builder"))," / ",wp.element.createElement(y,{isLink:!0,onClick:function(){return u({blocks:h(r)})}},w("append","jet-form-builder"))," ",wp.element.createElement("span",null,w("form settings and blocks","jet-form-builder")))))};function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var C=wp.components.Button,M=wp.element.useState,A=wp.i18n.__;function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var O=JetFBComponents.PatternInserterButton,B=wp.element.useState;var F=wp.element.createRoot,T=wp.data,P=T.subscribe,x=T.dispatch,_=document.createElement("div");_.classList.add("jfb-generate-form-ai-wrapper"),F(_).render(wp.element.createElement((function(){var e,t,r=(e=M(!1),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,l,o,a,i=[],c=!0,m=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(i.push(n.value),i.length!==t);c=!0);}catch(e){m=!0,l=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(m)throw l}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=r[0],l=r[1];return wp.element.createElement(React.Fragment,null,wp.element.createElement(C,{variant:"tertiary",iconSize:"16",icon:wp.element.createElement("svg",{width:"16",height:"16",viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},wp.element.createElement("path",{d:"M7.5 3.6L10 5L8.6 2.5L10 0L7.5 1.4L5 0L6.4 2.5L5 5L7.5 3.6ZM19.5 13.4L17 12L18.4 14.5L17 17L19.5 15.6L22 17L20.6 14.5L22 12L19.5 13.4ZM22 0L19.5 1.4L17 0L18.4 2.5L17 5L19.5 3.6L22 5L20.6 2.5L22 0ZM14.37 5.29C13.98 4.9 13.35 4.9 12.96 5.29L1.29 16.96C0.899998 17.35 0.899998 17.98 1.29 18.37L3.63 20.71C4.02 21.1 4.65 21.1 5.04 20.71L16.7 9.05C17.09 8.66 17.09 8.03 16.7 7.64L14.37 5.29ZM13.34 10.78L11.22 8.66L13.66 6.22L15.78 8.34L13.34 10.78Z",fill:"currentColor"})),onClick:function(){return l((function(e){return!e}))}},A("Generate Form with AI","jet-form-builder")),n&&wp.element.createElement(React.Fragment,null,wp.element.createElement(f,{setShowModal:l,footer:S})))}),null));var H=function(){var e=document.querySelector(".edit-post-header-toolbar");return!e||e.querySelector(".jfb-generate-form-ai-wrapper")||e.appendChild(_),null};wp.domReady((function(){P((function(){setTimeout(H,0)}))})),x("jet-forms/patterns").register({name:"ai",title:"Generate via AI",view:function(e){var t,r,n=e.pattern,l=(t=B(!1),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,l,o,a,i=[],c=!0,m=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(i.push(n.value),i.length!==t);c=!0);}catch(e){m=!0,l=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(m)throw l}}return i}}(t,r)||function(e,t){if(e){if("string"==typeof e)return I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?I(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=l[0],a=l[1];return wp.element.createElement(React.Fragment,null,wp.element.createElement("li",null,wp.element.createElement(O,{patternName:"ai",variant:"secondary",withPatternIcon:!0,iconSize:48,className:"block-editor-block-variation-picker__variation",onClick:function(){return a(!0)}}),wp.element.createElement("span",{className:"block-editor-block-variation-picker__variation-label"},n.title)),o&&wp.element.createElement(React.Fragment,null,wp.element.createElement(f,{setShowModal:a,footer:S})))},icon:wp.element.createElement("svg",{width:"16",height:"16",viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},wp.element.createElement("path",{d:"M7.5 3.6L10 5L8.6 2.5L10 0L7.5 1.4L5 0L6.4 2.5L5 5L7.5 3.6ZM19.5 13.4L17 12L18.4 14.5L17 17L19.5 15.6L22 17L20.6 14.5L22 12L19.5 13.4ZM22 0L19.5 1.4L17 0L18.4 2.5L17 5L19.5 3.6L22 5L20.6 2.5L22 0ZM14.37 5.29C13.98 4.9 13.35 4.9 12.96 5.29L1.29 16.96C0.899998 17.35 0.899998 17.98 1.29 18.37L3.63 20.71C4.02 21.1 4.65 21.1 5.04 20.71L16.7 9.05C17.09 8.66 17.09 8.03 16.7 7.64L14.37 5.29ZM13.34 10.78L11.22 8.66L13.66 6.22L15.78 8.34L13.34 10.78Z",fill:"currentColor"}))})})();