(()=>{"use strict";function e(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,l,a,i=[],m=!0,c=!1;try{if(l=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;m=!1}else for(;!(m=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);m=!0);}catch(e){c=!0,o=e}finally{try{if(!m&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return i}}(e,r)||function(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var r=wp.components,n=r.Modal,o=r.TextareaControl,l=r.Button,a=r.Notice,i=r.ExternalLink,m=r.Flex,c=wp.element.useState,u=wp.i18n.__,f=wp.apiFetch,p=JetFormBuilderParser,s=p.parseHTMLtoBlocks,d=p.getFormInnerFields,h=["#fake-ai","Registration form with minimum inputs","Opt-in form with gender selector like radio","Quiz form with 5 questions with choices about math"];const w=function(t){var r=t.setShowModal,p=t.footer,w=void 0===p?function(){return"Here may be buttons"}:p,y=e(c(""),2),b=y[0],g=y[1],v=e(c(""),2),j=v[0],E=v[1],S=e(c(!1),2),k=S[0],A=S[1],C=e(c(""),2),F=C[0],I=C[1];return wp.element.createElement(n,{style:{width:"60vw"},onRequestClose:function(){return r(!1)},title:u("Generate Form with AI","jet-form-builder"),className:"jet-form-edit-modal jfb-ai-modal"},F&&wp.element.createElement(a,{status:"error",onRemove:function(){return I("")}},wp.element.createElement(m,{direction:"column"},F,wp.element.createElement(i,{href:"https://support.crocoblock.com/support/home/"},u("Contact Crocoblock support","jet-form-builder")))),Boolean(j.length)?wp.element.createElement(React.Fragment,null,wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:j},style:{padding:"2em 1em",backgroundColor:"#f6f7f7",marginBottom:"1em"}}),wp.element.createElement(w,{clearHTML:function(){return E("")},formHTML:j,prompt:b})):wp.element.createElement(React.Fragment,null,wp.element.createElement(o,{label:u("Describe the form you want","jet-form-builder"),value:b,onChange:g,className:"jet-control-clear-full",help:u("Prompt example: Simple contact form","jet-form-builder")}),Boolean(b.length)&&wp.element.createElement(l,{variant:"primary",isBusy:k,disabled:k,onClick:function(){A(!0),f({path:"/jet-form-builder/v1/ai/generate",method:"POST",data:{prompt:b}}).then((function(e){I(""),E(d(e.form)),console.group(u("JFB: Parsed blocks from generated HTML","jet-form-builder")),console.log(s(e.form)),console.groupEnd()})).catch((function(e){var t;I(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:u("Undefined error.","jet-form-builder"))})).finally((function(){A(!1)}))}},u("Generate","jet-form-builder")),wp.element.createElement("h4",null,u("Tips to write good prompt:","jet-form-builder")),wp.element.createElement("ul",{style:{listStyle:"disc",paddingInlineStart:"1em"}},wp.element.createElement("li",null,u("Start with the main purpose of the form.","jet-form-builder")),wp.element.createElement("li",null,u("If you need some specific fields - describe \nthem also in prompt.","jet-form-builder")),wp.element.createElement("li",null,u("Better to use English language for \nthe prompt - AI understand it better than other","jet-form-builder"))),wp.element.createElement("h4",null,u("Examples of the good prompts:","jet-form-builder")),wp.element.createElement("ul",{style:{listStyle:"disc",paddingInlineStart:"1em"}},h.map((function(e){return wp.element.createElement("li",{key:e},wp.element.createElement(l,{onClick:function(){return g(e)},variant:"link"},e))})))))};function y(e){var t=e.name,r=e.attributes,n=JSON.stringify(r);return"\x3c!-- wp:".concat(t," ").concat(n," /--\x3e")}const b=function(e){return e.map(y).join("\n\n")};var g=wp.components,v=g.Flex,j=g.Button,E=wp.i18n.__,S=wp.apiFetch,k=JetFormBuilderParser.parseHTMLtoBlocks;const A=function(e){var t=e.clearHTML,r=e.formHTML,n=e.prompt;return wp.element.createElement(v,{justify:"flex-start"},wp.element.createElement(j,{variant:"primary",onClick:function(){var e=k(r);e.length?S({method:"POST",path:"/wp/v2/jet-form-builder",data:{title:n,content:b(e),status:"publish"}}).then((function(e){var t,r;window.location.href=(t=e.id,(r=new URL(JetFormBuilderAdmin.edit_url)).searchParams.set("post",t),r.href)})).catch(console.error):console.error(E("JFB: Invalid html","jet-form-builder"),r)}},E("Create form with this template","jet-form-builder")),wp.element.createElement(j,{variant:"secondary",onClick:t},E("Change generation prompt","jet-form-builder")))};function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var F=wp.element.useState,I=wp.i18n.__;const B=function(){var e,t,r=(e=F(!1),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,l,a,i=[],m=!0,c=!1;try{if(l=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;m=!1}else for(;!(m=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);m=!0);}catch(e){c=!0,o=e}finally{try{if(!m&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=r[0],o=r[1];return wp.element.createElement(React.Fragment,null,wp.element.createElement("a",{href:"#",className:"page-title-action",onClick:function(e){e.preventDefault(),o((function(e){return!e}))}},I("Generate with AI","jet-form-builder")),n&&wp.element.createElement(w,{setShowModal:o,footer:A}))};var T=wp.element.createRoot;wp.domReady((function(){var e=document.createElement("div");e.style.display="inline-flex",document.querySelector('.page-title-action[href*="post-new.php"]').after(e),T(e).render(wp.element.createElement(B,null))}))})();