(()=>{"use strict";const e=window.React,{globalTab:t,Tools:{withPlaceholder:a},getFormFieldsBlocks:l,convertListToFieldsMap:n}=JetFBActions,{ActionFieldsMap:i,WrapperRequiredControl:s,ActionFetchButton:o,DynamicPropertySelect:r,ToggleControl:c}=JetFBComponents,{withRequestFields:p,withSelectActionLoading:m}=JetFBHooks,{TextControl:_,SelectControl:d,BaseControl:u}=wp.components,{__:g}=wp.i18n,{useState:f,useEffect:b}=wp.element,{withSelect:h}=wp.data,{compose:v}=wp.compose,k={first_name:"firstName",last_name:"lastName"},y=v(h(p),h(m))((function(p){var m;const{settings:h,onChangeSettingObj:v,source:y,label:E,help:w,requestFields:F,loadingState:C}=p,j=t({slug:"active-campaign-tab"}),[A]=f((()=>[...l([],"--"),...F]));b((()=>{const e={};for(const[a,l]of Object.entries(null!==(t=h.fields_map)&&void 0!==t?t:{})){var t;k.hasOwnProperty(a)?e[k[a]]=l:e[a]=l}v({fields_map:e})}),[]),b((()=>{if(!C.success)return;const e=new Set(C.response.fields.map((e=>e.value))),t={};for(const[a,l]of Object.entries(h.fields_map))e.has(a)&&(t[a]=l);v({fields_map:t})}),[C.success]);const B=e=>{var t;return h.use_global?j[e]:null!==(t=h[e])&&void 0!==t?t:""};return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(c,{checked:h.use_global,onChange:e=>v({use_global:Boolean(e)})},g("Use","jet-form-builder")+" ",(0,e.createElement)("a",{href:JetFormEditorData.global_settings_url+"#active-campaign-tab"},g("Global Settings","jet-form-builder"))),(0,e.createElement)(u,{label:E("api_data"),key:"activecampaign_input_key"},(0,e.createElement)("div",{className:"jet-control-clear-full jet-d-flex-between"},(0,e.createElement)("div",null,(0,e.createElement)(_,{key:"api_url",help:E("api_url"),className:"jet-control-clear",disabled:h.use_global,value:B("api_url"),onChange:e=>v({api_url:e})}),(0,e.createElement)(_,{key:"api_key",help:E("api_key"),className:"jet-control-clear",disabled:h.use_global,value:B("api_key"),onChange:e=>v({api_key:e})})),(0,e.createElement)(o,{initialLabel:E("validate_api_key"),label:E("retry_request"),apiArgs:{...y.fetch,headers:{"API-TOKEN":B("api_key"),"API-URL":B("api_url")}}}))),(0,e.createElement)("div",{style:{paddingBottom:"1.2em"}},w("api_key_link_prefix")," ",(0,e.createElement)("a",{href:w("api_key_link")},w("api_key_link_suffix"))),C.success&&(0,e.createElement)(React.Fragment,null,(0,e.createElement)(d,{key:"activecampaign_select_lists",label:E("list_id"),labelPosition:"side",value:h.list_id,onChange:e=>v({list_id:e}),options:a(null!==(m=C.response.lists)&&void 0!==m?m:[])}),(0,e.createElement)(_,{key:"activecampaign_tags",label:E("tags"),value:h.tags,help:w("tags"),onChange:e=>v({tags:e})}),(0,e.createElement)(i,{label:E("fields_map"),fields:n(C.response.fields)},(0,e.createElement)(s,null,(0,e.createElement)(r,{properties:A})))))})),{addAction:E}=JetFBActions;E("active_campaign",y)})();