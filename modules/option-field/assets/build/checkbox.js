(()=>{"use strict";const t=function(t){return t.nextElementSibling.querySelector("input.text-field")},e=function(t,e,i){var n;if(t.checked=e?.includes(t.value),!t.checked)return;if(i.calcValue+=parseFloat(null!==(n=t.dataset?.calculate)&&void 0!==n?n:t.value),!i.isArray())return;const s=e.indexOf(t.value);e.splice(s,1)},{isEmpty:i}=JetFormBuilderFunctions,{InputData:n,ReactiveHook:s}=JetFormBuilderAbstract,{getParsedName:o}=JetFormBuilderFunctions;function r(t){return Array.isArray(t)?t:[t].filter(Boolean)}function u(){n.call(this),this.wrapper=null,this.isResetCalcValue=!1,this.isSupported=function(t){return t.classList.contains("checkradio-wrap")&&t.querySelector(".checkboxes-wrap")},this.addListeners=function(){this.enterKey=new s,this.wrapper.addEventListener("change",(()=>this.setValue())),this.wrapper.addEventListener("keydown",this.handleEnterKey.bind(this)),this.wrapper.addEventListener("focusout",(t=>{[...this.nodes].includes(t?.relatedTarget)||t?.relatedTarget?.closest?.(".jet-form-builder__field-wrap.custom-option")||this.reportOnBlur()})),this.addNewButton&&this.wrapper.addEventListener("click",(t=>{t?.target&&!this.addNewButton.isEqualNode(t.target)||(this.silenceSet([...this.value.current,!0]),this.getCustomNodes().at(-1).closest(".jet-form-builder__field-wrap").querySelector("span input.jet-form-builder__field").focus())})),this.isArray()&&this.sanitize(r),this.callable=null,this.sanitize((n=>function(n,s){s.calcValue=0;const o=s.isArray()?[...n]:n;for(const t of s.nodes)!t.dataset.custom&&e(t,o,s);if(!s.addNewButton)return n;const r=s.getCustomNodes();if(r.length&&!o.length)return n;for(let e=Math.max(r.length,o.length)-1;e>=0;e--){let n=r[e];const u=o[e];if(null===u){n.closest(".custom-option").remove();continue}if(void 0===n){if(!1===u)continue;s.addCustomOption(),n=s.nodes[s.nodes.length-1]}const a=t(n);a.disabled=!1===u,a.disabled||i(u)||!0===u||(s.calcValue+=1),a.value!==u&&"boolean"!=typeof u&&(a.value=u)}return n.filter((t=>null!==t))}(n,this)))},this.setValue=function(){this.value.current=this.getActiveValue(),this.value.applySanitizers(this.value.current)},this.setNode=function(t){t.jfbSync=this,this.nodes=t.getElementsByClassName("jet-form-builder__field checkboxes-field"),this.rawName=this.nodes[0].name,this.name=o(this.rawName),this.inputType="checkbox",this.wrapper=t,this.addNewButton=t.querySelector(".jet-form-builder__field-wrap.custom-option .add-custom-option")},this.getActiveValue=function(){var e;const i=[];for(const e of this.nodes){if(!e.dataset.custom&&!e.checked)continue;if(!e.dataset.custom){i.push(e.value);continue}const n=t(e);e.checked||n.value?n.value||!e.checked?n.value&&i.push(!!e.checked&&n.value):i.push(!0):i.push(null)}return this.isArray()?i:null!==(e=i?.[0])&&void 0!==e?e:""},this.isArray=function(){return Boolean(this.addNewButton)||this.nodes.item(0)?.name?.includes?.("[]")}}u.prototype=Object.create(n.prototype),u.prototype.addCustomOption=function(){const t=this.addNewButton.closest(".custom-option");return this.wrapper.insertBefore(this.getCustomOptionNode(),t)},u.prototype.getCustomOptionNode=function(){if(!this.addNewButton)return!1;const t=this.addNewButton.querySelector("template"),e=document.createElement("template");return e.innerHTML=t.innerHTML.trim(),e.content.firstChild},u.prototype.getCustomNodes=function(){return[...this.nodes].filter((t=>t.dataset.custom&&t.nextElementSibling))};const a=u,{addFilter:l}=JetPlugins.hooks;window.JetFormBuilderAbstract={...window.JetFormBuilderAbstract,CheckboxData:a},l("jet.fb.inputs","jet-form-builder/checkbox-field",(function(t){return[a,...t]}))})();