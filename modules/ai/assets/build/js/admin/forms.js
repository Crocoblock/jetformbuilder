(()=>{"use strict";function e(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,l,a,i=[],m=!0,u=!1;try{if(l=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;m=!1}else for(;!(m=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);m=!0);}catch(e){u=!0,o=e}finally{try{if(!m&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return i}}(e,r)||function(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var r=wp.components,n=r.Modal,o=r.TextareaControl,l=r.Button,a=wp.element.useState,i=wp.i18n.__,m=wp.apiFetch,u=JetFormBuilderParser,c=u.parseHTMLtoBlocks,f=u.getFormInnerFields,p=["#fake-ai","Registration form with minimum inputs","Opt-in form with gender selector like radio","Quiz form with 5 questions with choices about math"];const s=function(t){var r=t.setShowModal,u=t.footer,s=void 0===u?function(){return"Here may be buttons"}:u,d=e(a(""),2),h=d[0],w=d[1],y=e(a(""),2),b=y[0],g=y[1],v=e(a(!1),2),E=v[0],j=v[1];return wp.element.createElement(n,{style:{width:"60vw"},onRequestClose:function(){return r(!1)},title:i("Generate Form with AI","jet-form-builder")},Boolean(b.length)?wp.element.createElement(React.Fragment,null,wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:b},style:{padding:"2em 1em",backgroundColor:"#f6f7f7",marginBottom:"1em"}}),wp.element.createElement(s,{clearHTML:function(){return g("")},formHTML:b,prompt:h})):wp.element.createElement(React.Fragment,null,wp.element.createElement(o,{label:i("Describe the form you want","jet-form-builder"),value:h,onChange:w,help:i("Prompt example: Simple contact form","jet-form-builder")}),wp.element.createElement(l,{variant:"primary",isBusy:E,onClick:function(){j(!0),m({path:"/jet-form-builder/v1/ai/generate",method:"POST",data:{prompt:h}}).then((function(e){g(f(e.form)),console.group(i("JFB: Parsed blocks from generated HTML","jet-form-builder")),console.log(c(e.form)),console.groupEnd()})).catch((function(e){console.error(e)})).finally((function(){j(!1)}))}},i("Generate","jet-form-builder")),wp.element.createElement("h4",null,i("Tips to write good prompt:","jet-form-builder")),wp.element.createElement("ul",{style:{listStyle:"disc",paddingInlineStart:"1em"}},wp.element.createElement("li",null,i("Start with the main purpose of the form.","jet-form-builder")),wp.element.createElement("li",null,i("If you need some specific fields - describe \nthem also in prompt.","jet-form-builder")),wp.element.createElement("li",null,i("Better to use English language for \nthe prompt - AI understand it better than other","jet-form-builder"))),wp.element.createElement("h4",null,i("Examples of the good prompts:","jet-form-builder")),wp.element.createElement("ul",{style:{listStyle:"disc",paddingInlineStart:"1em"}},p.map((function(e){return wp.element.createElement("li",{key:e},wp.element.createElement(l,{onClick:function(){return w(e)},variant:"link"},e))})))))};function d(e){var t=e.name,r=e.attributes,n=JSON.stringify(r);return"\x3c!-- wp:".concat(t," ").concat(n," /--\x3e")}const h=function(e){return e.map(d).join("\n\n")};var w=wp.components,y=w.Flex,b=w.Button,g=wp.i18n.__,v=wp.apiFetch,E=JetFormBuilderParser.parseHTMLtoBlocks;const j=function(e){var t=e.clearHTML,r=e.formHTML,n=e.prompt;return wp.element.createElement(y,{justify:"flex-start"},wp.element.createElement(b,{variant:"primary",onClick:function(){var e=E(r);e.length?v({method:"POST",path:"/wp/v2/jet-form-builder",data:{title:n,content:h(e),status:"publish"}}).then((function(e){var t,r;window.location.href=(t=e.id,(r=new URL(JetFormBuilderAdmin.edit_url)).searchParams.set("post",t),r.href)})).catch(console.error):console.error(g("JFB: Invalid html","jet-form-builder"),r)}},g("Create form with this template","jet-form-builder")),wp.element.createElement(b,{variant:"secondary",onClick:t},g("Change generation prompt","jet-form-builder")))};function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var A=wp.element.useState,I=wp.i18n.__;const F=function(){var e,t,r=(e=A(!1),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,l,a,i=[],m=!0,u=!1;try{if(l=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;m=!1}else for(;!(m=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);m=!0);}catch(e){u=!0,o=e}finally{try{if(!m&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=r[0],o=r[1];return wp.element.createElement(React.Fragment,null,wp.element.createElement("a",{href:"#",className:"page-title-action",onClick:function(e){e.preventDefault(),o((function(e){return!e}))}},I("Generate with AI","jet-form-builder")),n&&wp.element.createElement(s,{setShowModal:o,footer:j}))};var T=wp.element.createRoot;wp.domReady((function(){var e=document.createElement("div");e.style.display="inline-flex",document.querySelector('.page-title-action[href*="post-new.php"]').after(e),T(e).render(wp.element.createElement(F,null))}))})();