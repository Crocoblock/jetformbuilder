(()=>{"use strict";function t(){}t.prototype.isSupported=function(t){return!1},t.prototype.observe=function(){},t.prototype.setOptions=function(t){},t.prototype.isPassed=function(){throw new Error("You must provide ConditionItem::isPassed function")},t.prototype.setList=function(t){this.list=t};const n=t;function e(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var r=JetFormBuilderAbstract.CalculatedFormula;function o(){n.call(this),this.isSupported=function(t){var n;return!(null==t||null===(n=t.field)||void 0===n||!n.length)},this.observe=function(){var t,n=this,e=this.getInput();this.list._fields=null!==(t=this.list._fields)&&void 0!==t?t:[],e&&!this.list._fields.includes(this.field)&&(this.list._fields.push(this.field),e.watch((function(){return n.list.onChangeRelated()})))},this.getInput=function(){return this.list.root.getInput(this.field)},this.isPassed=function(){var t=this.getInput();return!!t&&t.checker.check(this,t)},this.setOptions=function(t){var n=this;this.field=t.field,this.operator=t.operator,this.render_state=t.render_state,this.use_preset=t.use_preset;var o=null==t?void 0:t.value;if(Array.isArray(o)||(o=o.split(",").map((function(t){return t.trim()}))),this.use_preset)this.value=o;else{this.value={};for(var i=function(){var t,o,i=(t=u[s],o=2,function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i=[],s=!0,u=!1;try{for(e=e.call(t);!(s=(r=e.next()).done)&&(i.push(r.value),!n||i.length!==n);s=!0);}catch(t){u=!0,o=t}finally{try{s||null==e.return||e.return()}finally{if(u)throw o}}return i}}(t,o)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],l=i[1],c=new r(n.list.root);c.observe(l),c.setResult=function(){n.value[a]=""+c.calculate(),n.list.onChangeRelated()},c.setResult()},s=0,u=Object.entries(o);s<u.length;s++)i();this.value=Object.values(this.value)}}}o.prototype=Object.create(n.prototype),o.prototype.field=null,o.prototype.value=null,o.prototype.operator=null,o.prototype.use_preset=null;const i=o;function s(){n.call(this),this.isSupported=function(t){var n;return null!==(n=t.or_operator)&&void 0!==n&&n}}s.prototype=Object.create(n.prototype);const u=s;function a(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return l(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?l(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return s=t.done,t},e:function(t){u=!0,i=t},f:function(){try{s||null==e.return||e.return()}finally{if(u)throw i}}}}function l(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function c(t,n){this.root=n,this.setConditions(t)}c.prototype={root:null,conditions:[],invalid:[],onChangeRelated:function(){this.getResult()&&this.onMatchConditions()},onMatchConditions:function(){},observe:function(){var t,n=a(this.getConditions());try{for(n.s();!(t=n.n()).done;)t.value.observe()}catch(t){n.e(t)}finally{n.f()}},setConditions:function(t){var n=this;"string"==typeof t&&(t=JSON.parse(t)),this.conditions=t.map((function(t){return function(t,n){T.length||(T=M("jet.fb.conditional.types",[x,u,i]));var e,r=D(T);try{for(r.s();!(e=r.n()).done;){var o=new(0,e.value);if(o.isSupported(t))return o.setList(n),o.setOptions(t),o}}catch(t){r.e(t)}finally{r.f()}}(t,n)})).filter((function(t){return t}))},getResult:function(){this.invalid=[];var t,n={},e=0,r=a(this.getConditions());try{for(r.s();!(t=r.n()).done;){var o,i=t.value;i instanceof u?e++:(n[e]=null!==(o=n[e])&&void 0!==o?o:[],n[e].push(i))}}catch(t){r.e(t)}finally{r.f()}if(!(n=Object.values(n)).length)return!0;var s,l=a(n);try{for(l.s();!(s=l.n()).done;){var c=s.value;if(this.isValidGroup(c))return!0}}catch(t){l.e(t)}finally{l.f()}return!1},isValidGroup:function(t){var n,e=a(t);try{for(e.s();!(n=e.n()).done;){var r=n.value;if(!r.isPassed())return this.invalid.push(r),!1}}catch(t){e.e(t)}finally{e.f()}return!0},getConditions:function(){return this.conditions}};const f=c;function h(t,n){f.call(this,t,n)}h.prototype=Object.create(f.prototype),h.prototype.block=null;const d=h;var p=wp.hooks.doAction,y=JetFormBuilderAbstract.ReactiveVar,v=JetFormBuilderFunctions.validateInputsAll;function b(t,n){this.node=t,t.jfbConditional=this,this.root=n,this.isObserved=!1,this.list=null,this.page=null,this.multistep=null,this.comment=null,this.inputs=[],this.isRight=new y(null),this.isRight.make(),this.setConditions(),this.setInputs(),p("jet.fb.conditional.init",this)}b.prototype={setConditions:function(){var t=this,n=this.node.dataset.jfbConditional;this.list=new d(n,this.root),this.list.block=this,this.list.onChangeRelated=function(){t.isRight.current=t.list.getResult()}},setInputs:function(){this.willDomChange()&&(this.inputs=Array.from(this.node.querySelectorAll("[data-jfb-sync]")).map((function(t){return t.jfbSync})))},insertComment:function(){this.willDomChange()&&(this.comment=document.createComment(""),this.node.parentElement.insertBefore(this.comment,this.node.nextSibling))},observe:function(){var t=this;this.isObserved||(this.isObserved=!0,this.insertComment(),this.isRight.watch((function(){return t.runFunction()})),this.isRight.watch((function(){return t.validateInputs()})),this.list.observe())},runFunction:function(){var t=this.isRight.current;switch(this.getFunction()){case"show_dom":this.showBlockDom(t);break;case"hide_dom":this.showBlockDom(!t);break;case"show":this.showBlockCss(t);break;case"hide":this.showBlockCss(!t);break;case"disable":this.disableBlock(t)}},validateInputs:function(){v(this.inputs,!0).then((function(){})).catch((function(){}))},showBlockCss:function(t){this.node.style.display=t?"block":"none"},showBlockDom:function(t){t?this.comment.parentElement.insertBefore(this.node,this.comment):this.node.remove()},disableBlock:function(t){this.node.disabled=t},willDomChange:function(){return["show_dom","hide_dom"].includes(this.getFunction())},getFunction:function(){return this.node.dataset.jfbFunc}};const m=b;var g=JetFormBuilderFunctions.isEmpty;function w(){}w.prototype={isSupported:function(t){return!0},operators:{equal:function(t,n){return t===n[0]},empty:function(t){return g(t)},greater:function(t,n){return+t>+n[0]},less:function(t,n){return+t<+n[0]},between:function(t,n){return!(null==n||!n.length||null===t)&&n[0]<=+t&&+t<=n[1]},one_of:function(t,n){return!(null==n||!n.length)&&0<=n.indexOf(t)},contain:function(t,n){return!!t&&0<=t.indexOf(n[0])}},check:function(t,n){var e=n.value.current,r=t.value;return this.checkRaw(t.operator,e,r)},checkRaw:function(t,n,e){if(this.operators.hasOwnProperty(t))return this.operators[t](n,e);if(0!==t.indexOf("not_"))return!1;var r=t.slice(4);return!this.operators[r](n,e)}};const O=w;function j(){O.call(this),this.operators.one_of=function(t,n){return!(null==n||!n.length||null==t||!t.length)&&t.some((function(t){return-1!==n.indexOf(t)}))},this.operators.contain=function(t,n){return!(null==t||!t.length)&&t.some((function(t){return-1!==t.indexOf(n[0])}))},this.isSupported=function(t){return t.isArray()}}j.prototype=Object.create(O.prototype);const A=j;function S(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var C=JetFormBuilderFunctions.getTimestamp,k=JetFormBuilderConst,I=k.Min_In_Sec,_=k.Milli_In_Sec,R=(new Date).getTimezoneOffset();function B(){O.call(this),this.isSupported=function(t){var n,e,r=(n=t.nodes,e=1,function(t){if(Array.isArray(t))return t}(n)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i=[],s=!0,u=!1;try{for(e=e.call(t);!(s=(r=e.next()).done)&&(i.push(r.value),!n||i.length!==n);s=!0);}catch(t){u=!0,o=t}finally{try{s||null==e.return||e.return()}finally{if(u)throw o}}return i}}(n,e)||function(t,n){if(t){if("string"==typeof t)return S(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?S(t,n):void 0}}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return["date","time","datetime-local"].includes(r.type)},this.check=function(t,n){var e=C(n.value.current).time,r=t.value.map((function(n){var e=C(n),r=e.time;return"number"===e.type&&t.use_preset?r*_+R*I:r}));return this.checkRaw(t.operator,e,r)}}B.prototype=Object.create(O.prototype);const F=B;function P(){n.call(this),this.isSupported=function(t){return"render_state"===(null==t?void 0:t.operator)},this.getInput=function(){return this.list.root.getInput("_jfb_current_render_states")},this.observe=function(){var t=this;this.getInput().watch((function(){return t.list.onChangeRelated()}))},this.setOptions=function(t){var n;this.render_state=null!==(n=t.render_state)&&void 0!==n?n:[]},this.isPassed=function(){var t,n=this.getInput().value;return!(null===(t=n.current)||void 0===t||!t.length)&&this.render_state.some((function(t){return n.current.includes(t)}))}}P.prototype=Object.create(n.prototype),P.prototype.render_state=[];const x=P;function D(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return E(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?E(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return s=t.done,t},e:function(t){u=!0,i=t},f:function(){try{s||null==e.return||e.return()}finally{if(u)throw i}}}}function E(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var J,M=wp.hooks.applyFilters,T=[],U=[];function $(t,n){if(t.hasOwnProperty("jfbConditional"))return t.jfbConditional;var e=new m(t,n);return e.observe(),e.list.onChangeRelated(),e}function q(t){U.length||(U=M("jet.fb.conditional.checkers",[A,F,O]));var n,e=D(U);try{for(e.s();!(n=e.n()).done;){var r=new(0,n.value);if(r.isSupported(t))return r}}catch(t){e.e(t)}finally{e.f()}return null}function L(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function V(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?L(Object(e),!0).forEach((function(n){G(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):L(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function G(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function N(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var z=wp.hooks.addAction;z("jet.fb.observe.after","jet-form-builder/conditional-block",(function(t){var n,e=function(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return N(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?N(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return s=t.done,t},e:function(t){u=!0,i=t},f:function(){try{s||null==e.return||e.return()}finally{if(u)throw i}}}}(t.rootNode.querySelectorAll("[data-jfb-conditional]"));try{for(e.s();!(n=e.n()).done;)$(n.value,t)}catch(t){e.e(t)}finally{e.f()}}),20),z("jet.fb.input.makeReactive","jet-form-builder/conditional-block",(function(t){t.checker=q(t)})),window.JetFormBuilderAbstract=V(V({},null!==(J=window.JetFormBuilderAbstract)&&void 0!==J?J:{}),{},{ConditionItem:n,ConditionalBlock:m,createConditionalBlock:$,createChecker:q,ConditionsList:f})})();