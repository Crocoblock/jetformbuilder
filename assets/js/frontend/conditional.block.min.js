(()=>{"use strict";function t(){}t.prototype.isSupported=function(t){return!1},t.prototype.observe=function(){},t.prototype.setOptions=function(t){},t.prototype.isPassed=function(){throw new Error("You must provide ConditionItem::isPassed function")},t.prototype.setList=function(t){this.list=t};const e=t;function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var r=JetFormBuilderAbstract.CalculatedFormula;function o(){e.call(this),this.isSupported=function(t){var e;return!(null==t||null===(e=t.field)||void 0===e||!e.length)},this.observe=function(){var t,e=this,n=this.getInput();this.list._fields=null!==(t=this.list._fields)&&void 0!==t?t:[],n&&!this.list._fields.includes(this.field)&&(this.list._fields.push(this.field),n.watch((function(){return e.list.onChangeRelated()})))},this.getInput=function(){return this.list.root.getInput(this.field)},this.isPassed=function(){var t=this.getInput();return!!t&&t.checker.check(this,t)},this.setOptions=function(t){var e=this,o=t.field,i=t.operator,s=t.value,u=void 0===s?"":s,a=t.render_state,l=t.use_preset;if(this.field=o,this.operator=i,this.render_state=a,this.use_preset=l,Array.isArray(u)||(u=u.split(",").map((function(t){return t.trim()}))),this.use_preset)this.value=u;else{this.value={};for(var c=function(){var t,o,i=(t=h[f],o=2,function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],s=!0,u=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);s=!0);}catch(t){u=!0,o=t}finally{try{s||null==n.return||n.return()}finally{if(u)throw o}}return i}}(t,o)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=i[0],u=i[1],a=new r(u,e.list.root);a.setResult=function(){e.value[s]=""+a.calculate(),e.list.onChangeRelated()},a.setResult()},f=0,h=Object.entries(u);f<h.length;f++)c();this.value=Object.values(this.value)}}}o.prototype=Object.create(e.prototype),o.prototype.field=null,o.prototype.value=null,o.prototype.operator=null,o.prototype.use_preset=null;const i=o;function s(){e.call(this),this.isSupported=function(t){var e;return null!==(e=t.or_operator)&&void 0!==e&&e}}s.prototype=Object.create(e.prototype);const u=s;function a(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw i}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){this.root=e,this.setConditions(t)}c.prototype={root:null,conditions:[],invalid:[],onChangeRelated:function(){this.getResult()&&this.onMatchConditions()},onMatchConditions:function(){},observe:function(){var t,e=a(this.getConditions());try{for(e.s();!(t=e.n()).done;)t.value.observe()}catch(t){e.e(t)}finally{e.f()}},setConditions:function(t){var e=this;"string"==typeof t&&(t=JSON.parse(t)),this.conditions=t.map((function(t){return function(t,e){M.length||(M=E("jet.fb.conditional.types",[F,u,i]));var n,r=P(M);try{for(r.s();!(n=r.n()).done;){var o=new(0,n.value);if(o.isSupported(t))return o.setList(e),o.setOptions(t),o}}catch(t){r.e(t)}finally{r.f()}}(t,e)})).filter((function(t){return t}))},getResult:function(){this.invalid=[];var t,e={},n=0,r=a(this.getConditions());try{for(r.s();!(t=r.n()).done;){var o,i=t.value;i instanceof u?n++:(e[n]=null!==(o=e[n])&&void 0!==o?o:[],e[n].push(i))}}catch(t){r.e(t)}finally{r.f()}if(!(e=Object.values(e)).length)return!0;var s,l=a(e);try{for(l.s();!(s=l.n()).done;){var c=s.value;if(this.isValidGroup(c))return!0}}catch(t){l.e(t)}finally{l.f()}return!1},isValidGroup:function(t){var e,n=a(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(!r.isPassed())return this.invalid.push(r),!1}}catch(t){n.e(t)}finally{n.f()}return!0},getConditions:function(){return this.conditions}};const f=c;function h(t,e){f.call(this,t,e)}h.prototype=Object.create(f.prototype),h.prototype.block=null;const d=h;var p=wp.hooks.doAction,y=JetFormBuilderAbstract.ReactiveVar;function v(t,e){this.node=t,t.jfbConditional=this,this.root=e,this.isObserved=!1,this.list=null,this.page=null,this.multistep=null,this.comment=null,this.isRight=new y(null),this.isRight.make(),this.setConditions(),p("jet.fb.conditional.init",this)}v.prototype={setConditions:function(){var t=this,e=this.node.dataset.jfbConditional;this.list=new d(e,this.root),this.list.block=this,this.list.onChangeRelated=function(){t.isRight.current=t.list.getResult()}},insertComment:function(){this.willDomChange()&&(this.comment=document.createComment(""),this.node.parentElement.insertBefore(this.comment,this.node.nextSibling))},observe:function(){var t=this;this.isObserved||(this.isObserved=!0,this.insertComment(),this.isRight.watch((function(){return t.runFunction()})),this.list.observe())},runFunction:function(){var t=this.isRight.current;switch(this.getFunction()){case"show_dom":this.showBlockDom(t);break;case"hide_dom":this.showBlockDom(!t);break;case"show":this.showBlockCss(t);break;case"hide":this.showBlockCss(!t);break;case"disable":this.disableBlock(t)}},showBlockCss:function(t){this.node.style.display=t?"block":"none"},showBlockDom:function(t){t?this.comment.parentElement.insertBefore(this.node,this.comment):this.node.remove()},disableBlock:function(t){this.node.disabled=t},willDomChange:function(){return["show_dom","hide_dom"].includes(this.getFunction())},getFunction:function(){return this.node.dataset.jfbFunc}};const b=v;function m(){}m.prototype={isSupported:function(t){return!0},check:function(t,e){var n=e.value.current,r=t.value;switch(t.operator){case"equal":return n===r[0];case"greater":return+n>+r[0];case"less":return+n<+r[0];case"between":return!(null==r||!r.length)&&r[0]<=+n&&+n<=r[1];case"one_of":return!(null==r||!r.length)&&0<=r.indexOf(n);case"contain":return!!n&&0<=n.indexOf(r[0]);default:return!1}}};const g=m;function w(){g.call(this),this.isSupported=function(t){return t.isArray()},this.check=function(t,e){var n,r=e.value.current;switch(t.operator){case"one_of":return!(null===(n=t.value)||void 0===n||!n.length)&&r.some((function(e){return-1!==t.value.indexOf(e)}));case"contain":return r.some((function(e){return-1!==e.indexOf(t.value[0])}));default:return!1}}}w.prototype=Object.create(g.prototype);const O=w;function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var S=JetFormBuilderFunctions.getTimestamp,A=JetFormBuilderConst,C=A.Min_In_Sec,k=A.Milli_In_Sec,_=(new Date).getTimezoneOffset();function I(){g.call(this),this.isSupported=function(t){var e,n,r=(e=t.nodes,n=1,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],s=!0,u=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);s=!0);}catch(t){u=!0,o=t}finally{try{s||null==n.return||n.return()}finally{if(u)throw o}}return i}}(e,n)||function(t,e){if(t){if("string"==typeof t)return j(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return["date","time","datetime-local"].includes(r.type)},this.check=function(t,e){var n=S(e.value.current).time,r=t.value.map((function(e){var n=S(e),r=n.time;return"number"===n.type&&t.use_preset?r*k+_*C:r}));switch(t.operator){case"equal":return n===r[0];case"greater":return n>r[0];case"less":return n<r[0];case"between":return!(null==r||!r.length)&&r[0]<=n&&n<=r[1];default:return!1}}}I.prototype=Object.create(g.prototype);const B=I;function R(){e.call(this),this.isSupported=function(t){return"render_state"===(null==t?void 0:t.operator)},this.getInput=function(){return this.list.root.getInput("_jfb_current_render_states")},this.observe=function(){var t=this;this.getInput().watch((function(){return t.list.onChangeRelated()}))},this.setOptions=function(t){var e;this.render_state=null!==(e=t.render_state)&&void 0!==e?e:[]},this.isPassed=function(){var t,e=this.getInput().value;return!(null===(t=e.current)||void 0===t||!t.length)&&this.render_state.some((function(t){return e.current.includes(t)}))}}R.prototype=Object.create(e.prototype),R.prototype.render_state=[];const F=R;function P(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return x(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw i}}}}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var D,E=wp.hooks.applyFilters,M=[],J=[];function T(t,e){if(t.hasOwnProperty("jfbConditional"))return t.jfbConditional;var n=new b(t,e);return n.observe(),n.list.onChangeRelated(),n}function U(t){J.length||(J=E("jet.fb.conditional.checkers",[O,B,g]));var e,n=P(J);try{for(n.s();!(e=n.n()).done;){var r=new(0,e.value);if(r.isSupported(t))return r}}catch(t){n.e(t)}finally{n.f()}return null}function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(Object(n),!0).forEach((function(e){L(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function L(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var G=wp.hooks.addAction;G("jet.fb.observe.after","jet-form-builder/conditional-block",(function(t){var e,n=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return V(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw i}}}}(t.rootNode.querySelectorAll("[data-jfb-conditional]"));try{for(n.s();!(e=n.n()).done;)T(e.value,t)}catch(t){n.e(t)}finally{n.f()}}),20),G("jet.fb.input.makeReactive","jet-form-builder/conditional-block",(function(t){t.checker=U(t)})),window.JetFormBuilderAbstract=q(q({},null!==(D=window.JetFormBuilderAbstract)&&void 0!==D?D:{}),{},{ConditionItem:e,ConditionalBlock:b,createConditionalBlock:T,createChecker:U,ConditionsList:f})})();