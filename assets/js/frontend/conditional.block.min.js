(()=>{"use strict";function t(){}t.prototype.isSupported=function(t){return!1},t.prototype.observe=function(){},t.prototype.setOptions=function(t){},t.prototype.isPassed=function(){throw new Error("You must provide ConditionItem::isPassed function")},t.prototype.setList=function(t){this.list=t};const e=t;function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var r=JetFormBuilderAbstract.CalculatedFormula;function o(){e.call(this),this.isSupported=function(t){var e;return!(null==t||null===(e=t.field)||void 0===e||!e.length)},this.observe=function(){var t,e=this,n=this.getInput();this.list._fields=null!==(t=this.list._fields)&&void 0!==t?t:[],n&&!this.list._fields.includes(this.field)&&(this.list._fields.push(this.field),n.watch((function(){return e.list.onChangeRelated()})))},this.getInput=function(){return this.list.root.getInput(this.field)},this.isPassed=function(){var t=this.getInput();return!!t&&t.checker.check(this,t)},this.setOptions=function(t){var e=this,o=t.field,i=t.operator,s=t.value,a=t.render_state;this.field=o,this.operator=i,this.render_state=a,Array.isArray(s)||(s=s.split(",").map((function(t){return t.trim()}))),this.value={};for(var u=function(){var t,o,i=(t=c[l],o=2,function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);s=!0);}catch(t){a=!0,o=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return i}}(t,o)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=i[0],a=i[1],u=new r(a,e.list.root);u.setResult=function(){e.value[s]=""+u.calculate(),e.list.onChangeRelated()},u.setResult()},l=0,c=Object.entries(s);l<c.length;l++)u()}}o.prototype=Object.create(e.prototype);const i=o;function s(){e.call(this),this.isSupported=function(t){var e;return null!==(e=t.or_operator)&&void 0!==e&&e}}s.prototype=Object.create(e.prototype);const a=s;function u(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){this.root=e,this.setConditions(t)}c.prototype={root:null,conditions:[],invalid:[],onChangeRelated:function(){this.getResult()&&this.onMatchConditions()},onMatchConditions:function(){},observe:function(){var t,e=u(this.getConditions());try{for(e.s();!(t=e.n()).done;)t.value.observe()}catch(t){e.e(t)}finally{e.f()}},setConditions:function(t){var e=this;"string"==typeof t&&(t=JSON.parse(t)),this.conditions=t.map((function(t){return function(t,e){B.length||(B=I("jet.fb.conditional.types",[a,i]));var n,r=k(B);try{for(r.s();!(n=r.n()).done;){var o=new(0,n.value);if(o.isSupported(t))return o.setList(e),o.setOptions(t),o}}catch(t){r.e(t)}finally{r.f()}}(t,e)})).filter((function(t){return t}))},getResult:function(){this.invalid=[];var t,e={},n=0,r=u(this.getConditions());try{for(r.s();!(t=r.n()).done;){var o,i=t.value;i instanceof a?n++:(e[n]=null!==(o=e[n])&&void 0!==o?o:[],e[n].push(i))}}catch(t){r.e(t)}finally{r.f()}if(!(e=Object.values(e)).length)return!0;var s,l=u(e);try{for(l.s();!(s=l.n()).done;){var c=s.value;if(this.isValidGroup(c))return!0}}catch(t){l.e(t)}finally{l.f()}return!1},isValidGroup:function(t){var e,n=u(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(!r.isPassed())return this.invalid.push(r),!1}}catch(t){n.e(t)}finally{n.f()}return!0},getConditions:function(){return this.conditions}};const f=c;function h(t,e){f.call(this,t,e)}h.prototype=Object.create(f.prototype),h.prototype.block=null;const d=h;var p=wp.hooks.doAction;function y(t,e){this.node=t,t.jfbConditional=this,this.root=e,this.isObserved=!1,this.list=null,this.page=null,this.multistep=null,this.comment=null,this.setConditions(),p("jet.fb.conditional.init",this)}y.prototype={setConditions:function(){var t=this,e=this.node.dataset.jfbConditional;this.list=new d(e,this.root),this.list.block=this,this.list.onChangeRelated=function(){t.runFunction(t.list.getResult())}},insertComment:function(){this.willDomChange()&&(this.comment=document.createComment(""),this.node.parentElement.insertBefore(this.comment,this.node.nextSibling))},observe:function(){this.isObserved||(this.isObserved=!0,this.insertComment(),this.list.observe())},runFunction:function(t){switch(this.getFunction()){case"show_dom":this.showBlockDom(t);break;case"hide_dom":this.showBlockDom(!t);break;case"show":this.showBlockCss(t);break;case"hide":this.showBlockCss(!t);break;case"disable":this.disableBlock(t)}},showBlockCss:function(t){this.node.style.display=t?"block":"none"},showBlockDom:function(t){t?this.comment.parentElement.insertBefore(this.node,this.comment):this.node.remove()},disableBlock:function(t){this.node.disabled=t},willDomChange:function(){return["show_dom","hide_dom"].includes(this.getFunction())},getFunction:function(){return this.node.dataset.jfbFunc}};const v=y;function b(){}b.prototype={isSupported:function(){return!0},check:function(t,e){var n,r,o=e.value.current,i=t.value;switch(t.operator){case"equal":return o===i[0];case"greater":return o>i[0];case"less":return o<i[0];case"between":return!(null===(n=Object.keys(i))||void 0===n||!n.length)&&i[0]<=+o&&+o<=i[1];case"one_of":return!(null===(r=Object.keys(i))||void 0===r||!r.length)&&0<=i.indexOf(o);case"contain":return 0<=o.indexOf(i[0]);default:return!1}}};const m=b;var g=JetFormBuilderAbstract,w=g.CheckboxData,O=g.MultiSelectData;function j(){m.call(this),this.isSupported=function(t){return t instanceof w||t instanceof O},this.check=function(t,e){var n=e.value.current;switch(t.operator){case"one_of":return t.value.length&&n.some((function(e){return 0<=t.value.indexOf(e)}));case"contain":return n.some((function(e){return-1!==e.indexOf(t.value)}));default:return!1}}}j.prototype=Object.create(m.prototype);const C=j;function k(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var S,I=wp.hooks.applyFilters,B=[],P=[];function _(t,e){if(t.hasOwnProperty("jfbConditional"))return t.jfbConditional;var n=new v(t,e);return n.observe(),n.list.onChangeRelated(),n}function F(t){P.length||(P=I("jet.fb.conditional.checkers",[C,m]));var e,n=k(P);try{for(n.s();!(e=n.n()).done;){var r=new(0,e.value);if(r.isSupported(t))return r}}catch(t){n.e(t)}finally{n.f()}return null}function D(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function R(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?D(Object(n),!0).forEach((function(e){x(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function x(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var M=wp.hooks.addAction;M("jet.fb.observe.after","jet-form-builder/conditional-block",(function(t){var e,n=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return E(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}(t.rootNode.querySelectorAll("[data-jfb-conditional]"));try{for(n.s();!(e=n.n()).done;)_(e.value,t)}catch(t){n.e(t)}finally{n.f()}})),M("jet.fb.input.makeReactive","jet-form-builder/conditional-block",(function(t){t.checker=F(t)})),window.JetFormBuilderAbstract=R(R({},null!==(S=window.JetFormBuilderAbstract)&&void 0!==S?S:{}),{},{ConditionItem:e,ConditionalBlock:v,createConditionalBlock:_,createChecker:F,ConditionsList:f})})();