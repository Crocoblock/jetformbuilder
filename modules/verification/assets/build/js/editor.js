/*! For license information please see editor.js.LICENSE.txt */
(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function n(n){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?t(Object(o),!0).forEach((function(t){var r,i,a;r=n,i=t,a=o[t],(i=function(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(n)?n:String(n)}(i))in r?Object.defineProperty(r,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[i]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}))}return n}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var o=wp.i18n.__,i=wp.element.useMemo,a=wp.components,l=a.Button,c=a.Tooltip,u=JetFBHooks.useActionsEdit,f=JetFBComponents.ActionsAfterNewButtonSlotFill,s=JetFBActions.Tools,p=function(){return{id:s.getRandomID(),type:"verification",settings:{}}};const m={base:{jfbApiVersion:2,name:"jf-verification"},settings:{render:function(){var e=u(),t=e.actions,a=e.setActions,s=i(p,[]),m=t.some((function(e){return"verification"===e.type}));return wp.element.createElement(f.Fill,null,wp.element.createElement(c,{text:o(m?"You have already added the Verification action":"Click here to add Verification action","jet-form-builder"),delay:200,position:"top center"},wp.element.createElement(l,{onClick:function(){var e;a([n({},s)].concat(function(e){if(Array.isArray(e))return r(e)}(e=t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))},disabled:m,variant:"tertiary"},o("+ Verification","jet-form-builder"))))},icon:"filter"}};var d=wp.i18n.__;const y=function(){return wp.element.createElement(React.Fragment,null,wp.element.createElement("h3",{style:{marginTop:0}},d("Here is a brief description of how this verification action works:","jet-form-builder")),wp.element.createElement("p",null,d("1. The user sends the form for the first time. \nOn this stage, all actions that having the","jet-form-builder")+" ",wp.element.createElement("code",null,"DEFAULT.PROCESS")," "+d("event are executed. \nAfter that, Save Record action is executed, even if it is not present \nin the list of actions. At the same time, a unique token in a hashed \nform is stored in a separate table in the database.","jet-form-builder")),wp.element.createElement("p",null,d("2. The user receives an email containing a link to your \nsite with a key to the previously saved token. This can be achieved by sending \na letter to e-mail.","jet-form-builder")),wp.element.createElement("p",null,d("3. After clicking the link, the plugin checks the key with \nthe token. If the result is positive, the actions with either no events \nor with the","jet-form-builder")+" ",wp.element.createElement("code",null,"VERIFICATION.SUCCESS")," "+d("event are executed. If the result is negative, only actions with the","jet-form-builder")+" ",wp.element.createElement("code",null,"VERIFICATION.FAILED")," "+d("event will run.","jet-form-builder")))};var h="verification",v="VERIFICATION.SUCCESS",b="VERIFICATION.FAILED",w="_jfb_verification_token";function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function j(){j=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),l=new k(r||[]);return o(a,"_invoke",{value:x(e,n,l)}),a}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var p="suspendedStart",m="suspendedYield",d="executing",y="completed",h={};function v(){}function b(){}function w(){}var E={};u(E,a,(function(){return this}));var S=Object.getPrototypeOf,O=S&&S(S(L([])));O&&O!==n&&r.call(O,a)&&(E=O);var A=w.prototype=v.prototype=Object.create(E);function _(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(o,i,a,l){var c=s(e[o],e,i);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"==g(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,a,l)}),(function(e){n("throw",e,a,l)})):t.resolve(f).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,l)}))}l(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function x(t,n,r){var o=p;return function(i,a){if(o===d)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var l=r.delegate;if(l){var c=P(l,r);if(c){if(c===h)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=s(t,n,r);if("normal"===u.type){if(o=r.done?y:m,u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function P(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,P(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=s(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function F(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(F,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(g(t)+" is not iterable")}return b.prototype=w,o(A,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:b,configurable:!0}),b.displayName=u(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,u(e,c,"GeneratorFunction")),e.prototype=Object.create(A),e},t.awrap=function(e){return{__await:e}},_(C.prototype),u(C.prototype,l,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new C(f(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(A),u(A,c,"Generator"),u(A,a,(function(){return this})),u(A,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return l.type="throw",l.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function E(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}var S=wp.apiFetch;function O(){var e;return e=j().mark((function e(t){var n;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(t);case 2:return n=e.sent,e.abrupt("return",n.map((function(e){var t=e.title;return{value:e.id,label:t.rendered}})));case 4:case"end":return e.stop()}}),e)})),O=function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){E(i,r,o,a,l,"next",e)}function l(e){E(i,r,o,a,l,"throw",e)}a(void 0)}))},O.apply(this,arguments)}const A=function(e){return O.apply(this,arguments)};var _=wp.url.addQueryArgs;function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var P=wp.element,F=P.useState,I=P.useEffect;const k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=C(F([]),2),n=t[0],r=t[1],o=C(F(""),2),i=o[0],a=o[1];return I((function(){var t;i?A({path:(t=i,_("/wp/v2/pages",{search:t}))}).then(r):r(e)}),[i,e.length]),[n,a]},L=JSON.parse('[{"type":"send_email","settings":{"mail_to":"form","from_field":"_verify_user_email","subject":"[%CT::SiteName%] Confirm your email","content":"Please confirm your registration on site %CT::SiteName%.\\n\\n<b>If this was a mistake, ignore this email and nothing will happen.</b>\\n\\nTo complete the registration click on the link:\\n%_jfb_verification_url%"},"events":["DEFAULT.PROCESS"]}]');function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){var r,o,i;r=e,o=t,i=n[t],(o=function(e){var t=function(e,t){if("object"!==T(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==T(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===T(t)?t:String(t)}(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||V(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e){return function(e){if(Array.isArray(e))return J(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||V(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){if(e){if("string"==typeof e)return J(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(e,t):void 0}}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var M=wp.components,U=M.__experimentalToggleGroupControl,H=M.__experimentalToggleGroupControlOption,G=M.ToggleGroupControl,z=M.ToggleGroupControlOption,$=M.BaseControl,Y=M.ComboboxControl,Z=M.Button,q=M.Flex,W=M.SelectControl;G=G||U,z=z||H;var Q=wp.i18n.__,K=wp.element,X=K.useState,ee=K.useEffect,te=K.useMemo,ne=wp.url.addQueryArgs,re=wp.data.useDispatch,oe=JetFBComponents,ie=oe.BaseHelp,ae=oe.BaseAction,le=oe.ToggleControl,ce=JetFBHooks,ue=ce.useActions,fe=ce.useFields,se=ce.useCurrentAction,pe=JetFBActions,me=pe.Tools,de=(0,pe.convertFlow)(L),ye=function(e,t){var n,r=new Set(e.map((function(e){return e.value}))),o=[],i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=V(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw i}}}}(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;r.has(a.value)||o.push(a)}}catch(e){i.e(e)}finally{i.f()}return[].concat(R(e),o)};const he=function(e){var t,n,r=e.onChangeSettingObj,o=e.settings,i=N(ue([]),2),a=i[0],l=i[1],c=fe({withInner:!1},[]),u=se().currentAction,f=te((function(){return c.find((function(e){var t;return"email"===(null==e||null===(t=e.attributes)||void 0===t?void 0:t.field_type)}))}),[]),s=N(X(Boolean(o.mail_to)),2),p=s[0],m=s[1],d=te((function(){return a.findIndex((function(e){var t=e.events,n=void 0===t?[]:t,r=e.type;return-1!==n.indexOf(v)&&"redirect_to_page"===r}))}),[]),y=te((function(){return a.findIndex((function(e){var t=e.events,n=void 0===t?[]:t,r=e.type;return-1!==n.indexOf(b)&&"redirect_to_page"===r}))}),[]),h=null!==(t=a[d])&&void 0!==t?t:{},w=null!==(n=a[y])&&void 0!==n?n:{},g=N(X([]),2),j=g[0],E=g[1],S=N(k(j),2),O=S[0],_=S[1],C=N(k(j),2),x=C[0],P=C[1],F=re("jet-forms/actions").openActionSettings,I=function(e,t){var n=new ae({type:"redirect_to_page"});return n.events=[t],e&&(n.selfSettings={redirect_type:"static_page",redirect_page:e}),l([].concat(R(a.map((function(e){return u.id!==e.id?e:u}))),[n])),n};return ee((function(){A({path:"/wp/v2/pages"}).then((function(e){return E((function(t){return ye(t,e)}))}));var e=[o.success_page,o.failed_page].filter(Boolean);e.length&&A({path:ne("/wp/v2/pages",{include:e})}).then((function(e){return E((function(t){return ye(t,e)}))}))}),[]),"admin"===o.who_can?null:wp.element.createElement(React.Fragment,null,wp.element.createElement($,{label:Q("Email Field","jet-form-builder"),className:"jet-fb label-reset-margin"},wp.element.createElement("div",{className:"jet-control-clear-full"},wp.element.createElement(W,{value:o.mail_to,onChange:function(e){return r({mail_to:e})},options:me.withPlaceholder(c),hideLabelFromVision:!0}),wp.element.createElement(ie,null,Q("Send a verification link to the email address \nprovided in this field.","jet-form-builder")),!p&&Boolean(f)&&wp.element.createElement(ie,null,wp.element.createElement(q,{justify:"flex-start",gap:1},Q("(Suggestion) Choose the:","jet-form-builder"),wp.element.createElement(Z,{isLink:!0,onClick:function(){m(!0),r({mail_to:f.value})}},f.label),Q("field","jet-form-builder"))))),o.mail_to&&wp.element.createElement(le,{checked:Boolean(o.custom_email),onChange:function(e){return r({custom_email:e})},help:Q("If disabled, a standard verification email will be sent. \nIf enabled, you can create a custom verification email \nwith a separate Send Email action.","jet-form-builder")},wp.element.createElement(q,{gap:3,justify:"flex-start"},Q("Create custom verification email","jet-form-builder"),o.custom_email&&wp.element.createElement(Z,{isLink:!0,onClick:function(){var e,t=((e=N(de.list,1)[0]).selfSettings=D(D({},e.selfSettings),{},{from_field:o.mail_to}),l([].concat(R(a.map((function(e){return u.id!==e.id?e:u}))),[D({},e)])),e);F({index:a.length,item:t})}},Q("+ Add Send Email action","jet-form-builder")))),wp.element.createElement($,{label:Q("Success Page","jet-form-builder"),className:"control-flex"},wp.element.createElement(q,{style:{flex:3.1},direction:"column"},-1!==d?wp.element.createElement(React.Fragment,null,wp.element.createElement(ie,null,Q("You have already configured the \nRedirect to Page action with the event:","jet-form-builder"),wp.element.createElement("code",null,v)),wp.element.createElement(q,null,wp.element.createElement(Z,{icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24","aria-hidden":"true",focusable:"false"},wp.element.createElement("path",{d:"m19 7-3-3-8.5 8.5-1 4 4-1L19 7Zm-7 11.5H5V20h7v-1.5Z"})),onClick:function(){F({index:d,item:h})}},Q("Edit verification success redirect","jet-form-builder")))):wp.element.createElement(React.Fragment,null,wp.element.createElement(Y,{value:o.success_page,onChange:function(e){return r({success_page:e})},options:O,hideLabelFromVision:!0,onFilterValueChange:_}),wp.element.createElement(ie,{style:{marginTop:"-1em"}},Q("Select a page for the redirect after successful \nverification. By default, the user is redirected to the form page. Or","jet-form-builder")," ",wp.element.createElement(Z,{isLink:!0,onClick:function(){var e=I(o.success_page,v);F({index:a.length,item:D({},e)})}},Q("configure a separate Redirect to Page action","jet-form-builder")))))),wp.element.createElement($,{label:Q("Failed Page","jet-form-builder"),className:"control-flex"},wp.element.createElement(q,{style:{flex:3.1},direction:"column"},-1!==y?wp.element.createElement(React.Fragment,null,wp.element.createElement(ie,null,Q("You have already configured the\nRedirect to Page action with the event:","jet-form-builder"),wp.element.createElement("code",null,b)),wp.element.createElement(q,null,wp.element.createElement(Z,{icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24","aria-hidden":"true",focusable:"false"},wp.element.createElement("path",{d:"m19 7-3-3-8.5 8.5-1 4 4-1L19 7Zm-7 11.5H5V20h7v-1.5Z"})),onClick:function(){F({index:y,item:w})}},Q("Edit verification failed redirect","jet-form-builder")))):wp.element.createElement(React.Fragment,null,wp.element.createElement(Y,{value:o.failed_page,onChange:function(e){return r({failed_page:e})},options:x,hideLabelFromVision:!0,onFilterValueChange:P}),wp.element.createElement(ie,{style:{marginTop:"-1em"}},Q("Select a page for the redirect after verification \nfailure. By default, the user is redirected to the form page. Or","jet-form-builder")," ",wp.element.createElement(Z,{isLink:!0,onClick:function(){var e=I(o.failed_page,b);F({index:a.length,item:D({},e)})}},Q("configure a separate Redirect to Page action","jet-form-builder")))))))};function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var be=wp.components,we=be.TextControl,ge=be.BaseControl,je=be.Button,Ee=be.Flex,Se=be.SelectControl,Oe=wp.i18n.__,Ae=wp.element.useState,_e=JetFBComponents,Ce=_e.BaseHelp,xe=_e.ActionModalHeaderSlotFill;var Pe=JetFBHooks.useLoopedAction,Fe=JetFBComponents,Ie=Fe.EditActionSettingsButton,ke=Fe.ActionItemWrapper,Le=Fe.SelectActionsControl,Te=Fe.ActionItemMoreButton,Be=wp.components,De=Be.Flex,Ne=Be.CardBody;function Re(e){return Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Re(e)}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(n),!0).forEach((function(t){var r,o,i;r=e,o=t,i=n[t],(o=function(e){var t=function(e,t){if("object"!==Re(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Re(t)?t:String(t)}(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ue,He=wp.data,Ge=He.select,ze=He.dispatch,$e=function(){var e,t=Ge("core/editor").getEditedPostAttribute("meta")||{};if(Ue!==t._jf_actions&&"string"==typeof t._jf_actions){Ue=t._jf_actions;var n=JSON.parse(Ue),r=n.findIndex((function(e){return"verification"===e.type})),o=-1!==r,i=Ge("jet-forms/actions").getAction("verification");if(0<r&&o){var a=n[r];n.splice(r,1),ze("core/editor").editPost({meta:Me(Me({},t),{},{_jf_actions:JSON.stringify([a].concat((e=n,function(e){if(Array.isArray(e))return Ve(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ve(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())))})})}i.disabled!==o&&ze("jet-forms/actions").editAction("verification",{disabled:o})}};var Ye=JetFBComponents.BaseComputedField,Ze=wp.i18n,qe=(Ze.sprintf,Ze.__);function We(){Ye.call(this),this.getSupportedActions=function(){return["register_user"]}}We.prototype=Object.create(Ye.prototype),We.prototype.getName=function(){return w},We.prototype.getLabel=function(){return qe("Secure unique token","jet-form-builder")},We.prototype.getHelp=function(){return qe("A computed field. Usually used to save it in the password fields","jet-form-builder")};const Qe=We;function Ke(){Qe.call(this),this.isSupported=function(e){var t;return"verification"===e.type&&!e.selfSettings.who_can||"register_user"===e.type&&Object.values(null!==(t=e.selfSettings.fields_map)&&void 0!==t?t:{}).includes(w)}}Ke.prototype=Object.create(Qe.prototype);const Xe=Ke;var et=JetFBComponents.BaseComputedField,tt=wp.i18n,nt=(tt.sprintf,tt.__);function rt(){et.call(this),this.getSupportedActions=function(){return["verification"]}}rt.prototype=Object.create(et.prototype),rt.prototype.getName=function(){return"_jfb_verification_token_id"},rt.prototype.getLabel=function(){return nt("ID of secure unique token","jet-form-builder")},rt.prototype.getHelp=function(){return nt("A computed field from the Verification action.","jet-form-builder")};const ot=rt;var it=JetFBComponents.BaseComputedField,at=wp.i18n.__;function lt(){it.call(this),this.isSupported=function(e){return"verification"===e.type&&!e.selfSettings.who_can}}lt.prototype=Object.create(it.prototype),lt.prototype.getName=function(){return"_jfb_verification_url"},lt.prototype.getLabel=function(){return at("Verification URL","jet-form-builder")},lt.prototype.getHelp=function(){return at("A computed field from the Verification action. \nUsually used to send it using the Send by Email action.","jet-form-builder")};const ct=lt;function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ft=JetFBHooks,st=ft.useLoopedAction,pt=ft.useActionsEdit,mt=ft.useActions,dt=ft.useEvents,yt=JetFBComponents,ht=yt.EditActionSettingsButton,vt=yt.EditActionConditionsButton,bt=yt.ActionItemWrapper,wt=yt.SelectActionsControl,gt=yt.ActionItemMoreButton,jt=yt.ActionItemDetails,Et=wp.components,St=Et.Flex,Ot=Et.CardBody,At=Et.CardFooter,_t=Et.Button,Ct=wp.i18n.__;function xt(e){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(e)}function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(n),!0).forEach((function(t){var r,o,i;r=e,o=t,i=n[t],(o=function(e){var t=function(e,t){if("object"!==xt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==xt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===xt(t)?t:String(t)}(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var It=wp.hooks.addFilter,kt=JetFBActions,Lt=kt.addAction,Tt=kt.addComputedField,Bt=wp.data,Dt=Bt.subscribe,Nt=Bt.dispatch;window.JetFBComponents=Ft(Ft({},window.JetFBComponents),{},{TokenComputedField:Qe,TokenIDComputedField:ot,VerificationURLComputedField:ct}),Lt(h,(function(e){var t,n,r,o,i=e.onChangeSettingObj,a=e.settings,l=(r=Ae(!1),o=2,function(e){if(Array.isArray(e))return e}(r)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(r,o)||function(e,t){if(e){if("string"==typeof e)return ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ve(e,t):void 0}}(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=l[0],u=l[1];return wp.element.createElement(React.Fragment,null,wp.element.createElement(xe.Fill,null,wp.element.createElement(Ee,{gap:1},Oe("Edit Verification action","jet-form-builder"),wp.element.createElement(je,{variant:"tertiary",isPressed:c,icon:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24","aria-hidden":"true",focusable:"false"},wp.element.createElement("path",{d:"M12 4.75a7.25 7.25 0 100 14.5 7.25 7.25 0 000-14.5zM3.25 12a8.75 8.75 0 1117.5 0 8.75 8.75 0 01-17.5 0zM12 8.75a1.5 1.5 0 01.167 2.99c-.465.052-.917.44-.917 1.01V14h1.5v-.845A3 3 0 109 10.25h1.5a1.5 1.5 0 011.5-1.5zM11.25 15v1.5h1.5V15h-1.5z"})),onClick:function(){return u((function(e){return!e}))}}))),c&&wp.element.createElement(y,null),wp.element.createElement(Se,{label:Oe("Who can verify the submission","jet-form-builder"),value:null!==(t=a.who_can)&&void 0!==t?t:"",labelPosition:"side",options:[{value:"",label:Oe("User & Administrator","jet-form-builder")},{value:"admin",label:Oe("Administrator","jet-form-builder")}],onChange:function(e){return i({who_can:e})}}),wp.element.createElement(ge,{label:Oe("Link Lifespan","jet-form-builder"),className:"jet-fb label-reset-margin"},wp.element.createElement("div",{style:{flex:3}},wp.element.createElement(we,{value:null!==(n=a.lifespan)&&void 0!==n?n:4,onChange:function(e){return i({lifespan:e})}}),wp.element.createElement(Ce,{style:{marginTop:"-4px"}},Oe('Indicates for how many hours a verification link \nwill be active. If you leave this field empty or enter "0", it means \nverification can be completed at any given time.',"jet-form-builder")))),wp.element.createElement(he,{settings:a,onChangeSettingObj:i}))})),Tt(Qe,{isScoped:!0}),Tt(Xe),Tt(ot),Tt(ct),It("jet.fb.register.plugin.jf-actions-panel.before","jet-form-builder/verification",(function(e){return e.push(m),e})),It("jet.fb.action.item","jet-form-builder/verification-action",(function(e){return function(){return"verification"!==Pe().action.type?wp.element.createElement(e,null):wp.element.createElement(ke,null,wp.element.createElement(Ne,null,wp.element.createElement("div",null,wp.element.createElement(Le,null)),wp.element.createElement(De,{style:{marginTop:"0.5em"},justify:"space-between"},wp.element.createElement(Ie,null),wp.element.createElement(Te,{exclude:["up","down","off-on"]}))))}})),It("jet.fb.action.item","jet-form-builder/footer-notice-for-no-events",(function(e){return function(){var t,n,r,o=st().action,i=pt().updateActionObj,a=(n=mt(),r=1,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(n,r)||function(e,t){if(e){if("string"==typeof e)return ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ut(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],l=dt(o),c=a.some((function(e){return"verification"===e.type}));return null!=o&&null!==(t=o.events)&&void 0!==t&&t.length||"verification"===o.type||!c||1>=l.length?wp.element.createElement(e,null):wp.element.createElement(bt,null,wp.element.createElement(Ot,null,wp.element.createElement("div",null,wp.element.createElement(wt,null)),wp.element.createElement(St,{style:{marginTop:"0.5em"},justify:"space-between"},wp.element.createElement(ht,null),wp.element.createElement(vt,null),wp.element.createElement(gt,null),wp.element.createElement(jt,null))),wp.element.createElement(At,null,wp.element.createElement(St,{justify:"flex-start",style:{width:"auto"}},wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24",width:"24",height:"24","aria-hidden":"true",focusable:"false",style:{color:"var( --wp-components-color-accent-darker-10, #9e1313 )"}},wp.element.createElement("path",{fill:"currentColor",d:"M10 2c4.42 0 8 3.58 8 8s-3.58 8-8 8-8-3.58-8-8 3.58-8 8-8zm1.13 9.38l.35-6.46H8.52l.35 6.46h2.26zm-.09 3.36c.24-.23.37-.55.37-.96 0-.42-.12-.74-.36-.97s-.59-.35-1.06-.35-.82.12-1.07.35-.37.55-.37.97c0 .41.13.73.38.96.26.23.61.34 1.06.34s.8-.11 1.05-.34z"})),Ct("Runs on verification","jet-form-builder")),wp.element.createElement(_t,{isLink:!0,onClick:function(){return i(o.id,{events:["DEFAULT.PROCESS"]})},style:{textDecoration:"none",borderBottom:"2px dotted var(--wp-components-color-accent, var(--wp-admin-theme-color, #3858e9))"}},Ct("Run always","jet-form-builder"))))}})),Dt((function(){return setTimeout($e,0)})),Nt("jet-forms/actions").editAction(h,{provideEvents:function(){return[v,b]}})})();