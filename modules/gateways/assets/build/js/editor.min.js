(()=>{"use strict";var e=wp.compose.compose,t=wp.data,n=t.withSelect,r=t.withDispatch,a=wp.i18n.__,o=wp.components,i=o.TextControl,l=o.SelectControl,c=o.withNotices,u=wp.element.useEffect,s=JetFBActions.renderGateway,p=JetFBHooks,y=p.withSelectGateways,f=p.withDispatchGateways,m=JetFBComponents.ToggleControl;const w=e(n(y),r(f),c)((function(e){var t=e.setGatewayRequest,n=e.gatewaySpecific,r=e.setGatewaySpecific,o=e.gatewayScenario,c=e.setGatewayScenario,p=e.getSpecificOrGlobal,y=e.additionalSourceGateway,f=e.specificGatewayLabel,w=e.noticeOperations,b=e.noticeUI,g=o.id,d=void 0===g?"PAY_NOW":g;return u((function(){t({id:d})}),[d]),u((function(){t({id:d})}),[]),wp.element.createElement(React.Fragment,null,b,wp.element.createElement(m,{checked:n.use_global,onChange:function(e){return r({use_global:e})}},a("Use","jet-form-builder")+" ",wp.element.createElement("a",{href:JetFormEditorData.global_settings_url+"#payments-gateways__paypal"},a("Global Settings","jet-form-builder"))),wp.element.createElement(i,{label:f("client_id"),key:"paypal_client_id_setting",value:p("client_id"),onChange:function(e){return r({client_id:e})},disabled:n.use_global}),wp.element.createElement(i,{label:f("secret"),key:"paypal_secret_setting",value:p("secret"),onChange:function(e){return r({secret:e})},disabled:n.use_global}),wp.element.createElement(l,{labelPosition:"side",label:f("gateway_type"),value:d,onChange:function(e){c({id:e})},options:y.scenarios}),s("paypal",{noticeOperations:w},d))}));function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==b(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===b(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=wp.compose.compose,S=wp.data,_=S.withSelect,O=S.withDispatch,j=wp.components,E=j.TextControl,P=j.SelectControl,G=j.BaseControl,C=(j.RadioControl,JetFBHooks),F=C.withSelectFormFields,D=C.withSelectGateways,k=C.withDispatchGateways,A=(C.withSelectActionsByType,JetFBComponents.GatewayFetchButton);const R=h(_((function(){return d(d({},F([],"--").apply(void 0,arguments)),D.apply(void 0,arguments))})),O((function(){return d({},k.apply(void 0,arguments))})))((function(e){var t=e.gatewayGeneral,n=e.gatewaySpecific,r=e.setGateway,a=e.setGatewaySpecific,o=e.formFields,i=e.getSpecificOrGlobal,l=e.loadingGateway,c=e.scenarioSource,u=e.noticeOperations,s=e.scenarioLabel,p=e.globalGatewayLabel;return wp.element.createElement(React.Fragment,null,wp.element.createElement(G,{label:s("fetch_button_label")},wp.element.createElement("div",{className:"jet-user-fields-map__list"},!l.success&&!l.loading&&wp.element.createElement("span",{className:"description-controls"},s("fetch_button_help")),wp.element.createElement(A,{initialLabel:s("fetch_button"),label:s("fetch_button_retry"),apiArgs:d(d({},c.fetch),{},{data:{client_id:i("client_id"),secret:i("secret")}}),onFail:("error",function(e){u.removeNotice(t.gateway),u.createNotice({status:"error",content:e.message,id:t.gateway})})}))),l.success&&wp.element.createElement(React.Fragment,null,wp.element.createElement(E,{label:s("currency"),key:"paypal_currency_code_setting",value:n.currency,onChange:function(e){return a({currency:e})}}),wp.element.createElement(P,{label:p("price_field"),key:"form_fields_price_field",value:t.price_field,labelPosition:"side",onChange:function(e){r({price_field:e})},options:o})))}));function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==B(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===B(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=JetFBActions,I=T.gatewayAttr,U=T.renderGateway,L=T.renderGatewayWithPlaceholder,x=wp.i18n.__,H=wp.components,q=H.TextareaControl,M=H.BaseControl,W=wp.data,Y=W.withSelect,V=W.withDispatch,$=wp.compose.compose,z=JetFBHooks,K=z.withSelectGateways,Q=z.withDispatchGateways,X=I(),Z=I("labels");const ee=$(Y((function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},K.apply(void 0,arguments))})),V(Q))((function(e){var t=e.gatewayGeneral,n=e.setGatewayInner,r=e.loadingGateway,a=e.gatewayRequest,o=e.CURRENT_SCENARIO,i=e.currentScenario,l=function(e,t,r){n({key:e,value:J({},t,r)})},c=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t[e]&&t[e][n]?t[e][n]:r},u=function(e,t){l("messages",e,t)},s=function(e){return c("messages",e,X.messages[e])},p=wp.element.createElement(React.Fragment,null,L(t.gateway,{gatewayGeneral:t,CURRENT_SCENARIO:o,currentScenario:i},"macrosList",wp.element.createElement(M,{key:"payment_result_macros_base_control"},wp.element.createElement("h4",null,x("Available macros list: ","jet-form-builder"),wp.element.createElement("br",null),x("%gateway_amount% - payment amount returned from gateway template;","jet-form-builder"),wp.element.createElement("br",null),x("%gateway_status% - payment status returned from payment gateway;","jet-form-builder"),wp.element.createElement("br",null),x('%field_name% - replace "field_name" with any field name from the form;',"jet-form-builder"),wp.element.createElement("br",null)))),wp.element.createElement(q,{key:"payment_result_message_success",label:Z("message_success"),value:s("success"),onChange:function(e){return u("success",e)}}),wp.element.createElement(q,{key:"payment_result_message_failed",label:Z("message_failed"),value:s("failed"),onChange:function(e){return u("failed",e)}}));return wp.element.createElement(React.Fragment,null,U(t.gateway,{setValueInObject:l,getNotifications:c}),(-1===a.id||r.success||!a.id.includes(t.gateway))&&p)}));function te(e){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},te(e)}function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ae(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==te(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===te(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,l=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}(e,t)||ie(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(e,t){if(e){if("string"==typeof e)return le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?le(e,t):void 0}}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ce=wp.components,ue=ce.RadioControl,se=ce.Button,pe=wp.data,ye=pe.withDispatch,fe=pe.withSelect,me=wp.element,we=me.useState,be=me.useEffect,ge=wp.i18n.__,de=wp.compose.compose,ve=JetFBComponents.ActionModal,he=JetFBHooks,Se=he.withDispatchGateways,_e=he.withSelectGateways,Oe=he.useMetaState,je=window.JetFormEditorData.gateways;const Ee=de(ye(Se),fe(_e))((function(e){var t,n=e.setGateway,r=e.setGatewayScenario,a=e.clearGateway,o=e.clearScenario,i=e.gatewayGeneral,l=e.gatewayScenario,c=oe(Oe("_jf_gateways"),2),u=c[0],s=c[1],p=oe(we(!1),2),y=p[0],f=p[1];be((function(){var e;y?(n(u),r(null===(e=u[u.gateway])||void 0===e?void 0:e.scenario)):(a(),o())}),[y]);var m,w,b=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!1!==e&&s(e),f(!1)};return wp.element.createElement(React.Fragment,null,wp.element.createElement(ue,{key:"gateways_radio_control",selected:null!==(t=u.gateway)&&void 0!==t?t:"none",options:[{label:"None",value:"none"}].concat((w=je.list,function(e){if(Array.isArray(e))return le(e)}(w)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(w)||ie(w)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),onChange:function(e){s(re(re({},u),{},{gateway:e}))}}),"none"!==u.gateway&&u.gateway&&wp.element.createElement(se,{onClick:function(){return f(!0)},icon:"admin-tools",style:{margin:"1em 0"},isSecondary:!0},ge("Edit","jet-form-builder")),y&&wp.element.createElement(ve,{classNames:["width-60"],onRequestClose:function(){return b()},onCancelClick:function(){return b()},onUpdateClick:function(){return b(re(re({},i),{},ae({},i.gateway,re(re({},i[i.gateway]||{}),{},{scenario:l}))))},title:"Edit ".concat((m=u.gateway,je.list.find((function(e){return e.value===m})).label)," Settings")},wp.element.createElement(ee,null)))})),Pe={base:{name:"jf-gateways-panel",title:(0,wp.i18n.__)("Gateways Settings","jet-form-builder")},settings:{render:Ee,icon:"money-alt"}};var Ge=JetFBActions.registerGateway,Ce=wp.hooks.addFilter,Fe=(wp.i18n.__,"paypal");Ge(Fe,w),Ge(Fe,R,"PAY_NOW"),Ce("jet.fb.register.plugin.jf-validation-panel.after","jet-form-builder/gateways",(function(e){return e.push(Pe),e}))})();