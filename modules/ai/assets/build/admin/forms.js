(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,r=window.wp.components,n=window.wp.element,o=window.wp.i18n,l=window.wp.apiFetch;var a=e.n(l);const{parseHTMLtoBlocks:i,getFormInnerFields:m}=JetFormBuilderParser,s=["Registration form with minimum inputs","Opt-in form with gender selector like radio","Quiz form with 5 questions with choices about math"],c=function({setShowModal:e,footer:l=(()=>"Here may be buttons")}){const[c,u]=(0,n.useState)(""),[d,p]=(0,n.useState)(""),[f,h]=(0,n.useState)(!1),[b,_]=(0,n.useState)(""),[w,g]=(0,n.useState)(0),[E,y]=(0,n.useState)(0);return(0,t.createElement)(r.Modal,{style:{width:"60vw"},onRequestClose:()=>e(!1),title:(0,t.createElement)(r.Flex,null,(0,o.__)("Generate Form with AI","jet-form-builder"),(0,t.createElement)("span",{className:"badge"},(0,o.__)("Beta. Limited 10 requests per month","jet-form-builder"))),className:"jfb-ai-modal"},b&&(0,t.createElement)(r.Notice,{status:"error",onRemove:()=>_("")},(0,t.createElement)(r.Flex,{direction:"column"},b,(0,t.createElement)(r.ExternalLink,{href:"https://support.crocoblock.com/support/home/"},(0,o.__)("Contact Crocoblock support","jet-form-builder")))),Boolean(d.length)?(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{dangerouslySetInnerHTML:{__html:d},style:{padding:"2em 1em",backgroundColor:"#f6f7f7",marginBottom:"1em"}}),(0,t.createElement)(l,{clearHTML:()=>p(""),formHTML:d,prompt:c},(0,t.createElement)("span",{style:{flex:"1",textAlign:"end",color:"rgb( 117, 117, 117 )"}},(0,o.sprintf)((0,o.__)("Requests used: %d/%d","jet-form-builder"),w,E)))):(0,t.createElement)(t.Fragment,null,(0,t.createElement)(r.TextareaControl,{label:(0,o.__)("Describe the form you want","jet-form-builder"),value:c,onChange:u,help:(0,o.__)("Prompt example: Simple contact form","jet-form-builder")}),Boolean(c.length)&&(0,t.createElement)(r.Button,{variant:"primary",isBusy:f,disabled:f,onClick:()=>{h(!0),a()({path:"/jet-form-builder/v1/ai/generate",method:"POST",data:{prompt:c}}).then((e=>{_(""),p(m(e.form)),console.group((0,o.__)("JFB: Parsed blocks from generated HTML","jet-form-builder")),console.log(i(e.form)),console.groupEnd(),g(e.usage),y(e.limit)})).catch((e=>{var t;_(null!==(t=e?.message)&&void 0!==t?t:(0,o.__)("Undefined error.","jet-form-builder"))})).finally((()=>{h(!1)}))}},(0,o.__)("Generate","jet-form-builder")),(0,t.createElement)("h4",null,(0,o.__)("Tips to write good prompt:","jet-form-builder")),(0,t.createElement)("ul",{style:{listStyle:"disc",paddingInlineStart:"1em"}},(0,t.createElement)("li",null,(0,o.__)("Start with the main purpose of the form.","jet-form-builder")),(0,t.createElement)("li",null,(0,o.__)("If you need specific fields â€“ describe them in the prompt as well.","jet-form-builder")),(0,t.createElement)("li",null,(0,o.__)("It is better to use the English language for the prompt, as AI understands it better than others.","jet-form-builder"))),(0,t.createElement)("h4",null,(0,o.__)("Examples of the good prompts:","jet-form-builder")),(0,t.createElement)("ul",{style:{listStyle:"disc",paddingInlineStart:"1em"}},s.map((e=>(0,t.createElement)("li",{key:e},(0,t.createElement)(r.Button,{onClick:()=>u(e),variant:"link"},e)))))))};function u({name:e,attributes:t}){return`\x3c!-- wp:${e} ${JSON.stringify(t)} /--\x3e`}const d=function(e){return e.map(u).join("\n\n")},{parseHTMLtoBlocks:p}=JetFormBuilderParser,f=function({clearHTML:e,formHTML:n,prompt:l,children:i=null}){return(0,t.createElement)(r.Flex,{justify:"flex-start"},(0,t.createElement)(r.Button,{variant:"primary",onClick:()=>{const e=p(n);e.length?a()({method:"POST",path:"/wp/v2/jet-form-builder",data:{title:l,content:d(e),status:"publish"}}).then((e=>{window.location.href=(e=>{const t=new URL(JetFormBuilderAdmin.edit_url);return t.searchParams.set("post",e),t.href})(e.id)})).catch(console.error):console.error((0,o.__)("JFB: Invalid html","jet-form-builder"),n)}},(0,o.__)("Create form with this template","jet-form-builder")),(0,t.createElement)(r.Button,{variant:"secondary",onClick:e},(0,o.__)("Change generation prompt","jet-form-builder")),i)},h=function(){const[e,r]=(0,n.useState)(!1);return(0,t.createElement)(t.Fragment,null,(0,t.createElement)("a",{href:"#",className:"page-title-action",onClick:e=>{e.preventDefault(),r((e=>!e))}},(0,o.__)("Generate with AI","jet-form-builder")),e&&(0,t.createElement)(c,{setShowModal:r,footer:f}))},b=window.wp.domReady;e.n(b)()((()=>{const e=document.createElement("div");e.style.display="inline-flex",document.querySelector('.page-title-action[href*="post-new.php"]').after(e),(0,n.createRoot)(e).render((0,t.createElement)(h,null))}))})();