(()=>{"use strict";const e=window.React,{globalTab:t,Tools:{withPlaceholder:a},getFormFieldsBlocks:l,convertListToFieldsMap:i}=JetFBActions,{ActionFieldsMap:n,WrapperRequiredControl:s,ActionFetchButton:o,DynamicPropertySelect:c,ToggleControl:r}=JetFBComponents,{withRequestFields:p,withSelectActionLoading:m}=JetFBHooks,{TextControl:d,SelectControl:u,BaseControl:_}=wp.components,{__:g}=wp.i18n,{useState:f,useEffect:b}=wp.element,{withSelect:h}=wp.data,{compose:v}=wp.compose,w={first_name:"firstName",last_name:"lastName"},E=v(h(p),h(m))((function(p){var m;const{settings:h,onChangeSettingObj:v,source:E,label:y,help:k,requestFields:C,loadingState:F}=p,j=t({slug:"active-campaign-tab"}),[A]=f((()=>[...l([],"--"),...C]));b((()=>{const e={};for(const[a,l]of Object.entries(null!==(t=h.fields_map)&&void 0!==t?t:{})){var t;w.hasOwnProperty(a)?e[w[a]]=l:e[a]=l}v({fields_map:e})}),[]),b((()=>{if(!F.success)return;const e=new Set(F.response.fields.map((e=>e.value))),t={};for(const[a,l]of Object.entries(h.fields_map))e.has(a)&&(t[a]=l);v({fields_map:t})}),[F.success]);const B=e=>{var t;return h.use_global?j[e]:null!==(t=h[e])&&void 0!==t?t:""};return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(r,{checked:h.use_global,onChange:e=>v({use_global:Boolean(e)})},g("Use","jet-form-builder")+" ",(0,e.createElement)("a",{href:JetFormEditorData.global_settings_url+"#active-campaign-tab"},g("Global Settings","jet-form-builder"))),(0,e.createElement)(_,{label:y("api_data"),key:"activecampaign_input_key"},(0,e.createElement)("div",{className:"jet-control-clear-full jet-d-flex-between"},(0,e.createElement)("div",null,(0,e.createElement)(d,{key:"api_url",help:y("api_url"),className:"jet-control-clear",disabled:h.use_global,value:B("api_url"),onChange:e=>v({api_url:e})}),(0,e.createElement)(d,{key:"api_key",help:y("api_key"),className:"jet-control-clear",disabled:h.use_global,value:B("api_key"),onChange:e=>v({api_key:e})})),(0,e.createElement)(o,{initialLabel:y("validate_api_key"),label:y("retry_request"),apiArgs:{...E.fetch,headers:{"API-TOKEN":B("api_key"),"API-URL":B("api_url")}}}))),(0,e.createElement)("div",{style:{paddingBottom:"1.2em"}},k("api_key_link_prefix")," ",(0,e.createElement)("a",{href:k("api_key_link")},k("api_key_link_suffix"))),F.success&&(0,e.createElement)(React.Fragment,null,(0,e.createElement)(u,{key:"activecampaign_select_lists",label:y("list_id"),labelPosition:"side",value:h.list_id,onChange:e=>v({list_id:e}),options:a(null!==(m=F.response.lists)&&void 0!==m?m:[])}),(0,e.createElement)(d,{key:"activecampaign_tags",label:y("tags"),value:h.tags,help:k("tags"),onChange:e=>v({tags:e})}),(0,e.createElement)(n,{label:y("fields_map"),fields:i(F.response.fields)},(0,e.createElement)(s,null,(0,e.createElement)(c,{properties:A})))))})),y=window.wp.i18n,k=(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,e.createElement)("rect",{x:"0",fill:"none",width:"20",height:"20"}),(0,e.createElement)("g",null,(0,e.createElement)("path",{d:"M16 1.1L4 5.9c-1.1.4-2 1.8-2 3v8.7c0 1.2.9 1.8 2 1.4l12-4.8c1.1-.4 2-1.8 2-3V2.5c0-1.2-.9-1.8-2-1.4zm.6 2.6l-6 9.3-6.7-4.5c-.1-.1-.4-.4-.2-.7.2-.4.7-.2.7-.2l6.3 2.3s4.8-6.3 5.1-6.7c.1-.2.4-.3.7-.1.3.2.2.5.1.6z"}))),C={type:"active_campaign",label:(0,y.__)("Active Campaign","jet-form-builder"),edit:E,icon:k,docHref:"https://jetformbuilder.com/features/activecampaign/",category:"communication"};(0,window.wp.data.dispatch)("jet-forms/actions").registerAction(C)})();