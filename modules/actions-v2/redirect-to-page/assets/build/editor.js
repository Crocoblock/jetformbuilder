(()=>{"use strict";const e=window.React,t=window.wp.components,r=window.jfb.components,n=window.wp.i18n;var o=function(){const e=Array.prototype.slice.call(arguments).filter(Boolean),t={},r=[];e.forEach((e=>{(e?e.split(" "):[]).forEach((e=>{if(e.startsWith("atm_")){const[,r]=e.split("_");t[r]=e}else r.push(e)}))}));const n=[];for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push(t[e]);return n.push(...r),n.join(" ")};const l=window.wp.data,i=window.wp.element,a=window.jfb.actions,c=window.wp.compose,s=window.jfb.blocksToActions,d=function({settings:d,onChangeSettingObj:u}){const p=function({fields:e}){const t=(0,l.useSelect)((e=>{const{type:t}=e(a.STORE_NAME).getCurrentAction();return e(a.STORE_NAME).getAction(t)}),[]);return(0,i.useMemo)((()=>t.redirectTypes.filter((({isSupported:t=(()=>!0)})=>t({fields:e})))),[])}({fields:(0,s.useFields)({withInner:!1})}),_=(0,c.useInstanceId)(r.RowControl,"jfb-control"),{hasError:m,setShowError:g}=(0,a.useActionValidatorProvider)({isSupported:e=>"redirect_type"===e?.property});return(0,e.createElement)(r.RowControl,{createId:!1},(0,e.createElement)(r.RequiredLabel,{htmlFor:_},(0,n.__)("Redirect to","jet-form-builder")),(0,e.createElement)(t.Flex,{className:o(r.RowControlEndStyle,m&&r.ControlWithErrorStyle),direction:"column"},m&&(0,e.createElement)(r.IconText,null,(0,n.__)("Please fill this required field","jet-form-builder")),(0,e.createElement)(t.SelectControl,{id:_,value:d.redirect_type,options:[{value:"",label:(0,n.__)("Set a redirect to...","jet-form-builder")},...p],onChange:e=>u({redirect_type:e}),onBlur:()=>g(!0),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})))},u=window.wp.coreData,p=function({settings:o,onChangeSettingObj:i}){var s;const{hasError:d}=(0,a.useActionValidatorProvider)({isSupported:e=>"redirect_page"===e?.property}),[,p,_]=(0,c.useDebouncedInput)(""),m=(0,l.useSelect)((e=>e("core").getEntityRecord("postType","page",o.redirect_page)),[]),g=(0,u.useEntityRecords)("postType","page",{per_page:20,search:_}),E=null!==(s=g.records?.filter?.((({id:e})=>e!==m?.id)).map?.((e=>({value:e.id,label:e.title.raw}))))&&void 0!==s?s:[];return(0,e.createElement)(r.RowControl,{createId:!1},(0,e.createElement)(r.RequiredLabel,null,(0,n.__)("Select page","jet-form-builder")),(0,e.createElement)(r.RowControlEnd,{hasError:d},(0,e.createElement)(t.ComboboxControl,{value:+o.redirect_page,options:m?.id?[{value:m.id,label:m.title.raw},...E]:E,onChange:e=>i({redirect_page:e}),onFilterValueChange:p,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})))},{PresetButton:_,MacrosFields:m}=JetFBComponents,g=function({settings:l,onChangeSettingObj:i}){const{hasError:s,setShowError:d}=(0,a.useActionValidatorProvider)({isSupported:e=>"redirect_url"===e?.property}),u=(0,c.useInstanceId)(r.RowControl,"jfb-control");return(0,e.createElement)(r.RowControl,{createId:!1},(0,e.createElement)(r.LabelWithActions,null,(0,e.createElement)(r.RequiredLabel,{htmlFor:u},(0,n.__)("Redirect URL","jet-form-builder")),(0,e.createElement)(_,{value:l.redirect_url,onChange:e=>i({redirect_url:e})}),(0,e.createElement)(m,{onClick:e=>{var t;return i({redirect_url:(null!==(t=l.redirect_url)&&void 0!==t?t:"")+e})},withCurrent:!0})),(0,e.createElement)(t.Flex,{className:o(r.RowControlEndStyle,s&&r.ControlWithErrorStyle),direction:"column"},s&&(0,e.createElement)(r.IconText,null,(0,n.__)("Please fill this required field","jet-form-builder")),(0,e.createElement)(t.TextControl,{id:u,value:l.redirect_url,onChange:e=>i({redirect_url:e}),onBlur:()=>d(!0),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})))},{useFields:E}=JetFBHooks,h=function({settings:o,onChangeSettingObj:l}){const i=E({withInner:!1}).map((({value:e})=>e));return(0,e.createElement)(r.RowControl,{createId:!1},(0,e.createElement)(r.Label,null,(0,n.__)("URL Query arguments","jet-form-builder")),(0,e.createElement)(t.FormTokenField,{label:(0,n.__)("Add field","jet-form-builder"),value:o.redirect_args,suggestions:i,onChange:e=>l({redirect_args:e}),__experimentalExpandOnFocus:!0,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}))},w=function({settings:o,onChangeSettingObj:l}){const i=(0,c.useInstanceId)(r.RowControl,"jfb-control");return(0,e.createElement)(r.RowControl,{createId:!1},(0,e.createElement)(r.Label,{htmlFor:i},(0,n.__)("URL Hash","jet-form-builder")),(0,e.createElement)(t.TextControl,{id:i,value:o.redirect_hash,onChange:e=>l({redirect_hash:e}),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}))},b=window.wp.primitives,f=(0,e.createElement)(b.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,e.createElement)(b.Path,{d:"M19.75 9c0-1.257-.565-2.197-1.39-2.858-.797-.64-1.827-1.017-2.815-1.247-1.802-.42-3.703-.403-4.383-.396L11 4.5V6l.177-.001c.696-.006 2.416-.02 4.028.356.887.207 1.67.518 2.216.957.52.416.829.945.829 1.688 0 .592-.167.966-.407 1.23-.255.281-.656.508-1.236.674-1.19.34-2.82.346-4.607.346h-.077c-1.692 0-3.527 0-4.942.404-.732.209-1.424.545-1.935 1.108-.526.579-.796 1.33-.796 2.238 0 1.257.565 2.197 1.39 2.858.797.64 1.827 1.017 2.815 1.247 1.802.42 3.703.403 4.383.396L13 19.5h.714V22L18 18.5 13.714 15v3H13l-.177.001c-.696.006-2.416.02-4.028-.356-.887-.207-1.67-.518-2.216-.957-.52-.416-.829-.945-.829-1.688 0-.592.167-.966.407-1.23.255-.281.656-.508 1.237-.674 1.189-.34 2.819-.346 4.606-.346h.077c1.692 0 3.527 0 4.941-.404.732-.209 1.425-.545 1.936-1.108.526-.579.796-1.33.796-2.238z"})),C={type:"redirect_to_page",label:(0,n.__)("Redirect to Page","jet-form-builder"),edit:function(n){const{settings:o,onChangeSettingObj:l}=n;return(0,e.createElement)(t.Flex,{direction:"column"},(0,e.createElement)(d,{settings:o,onChangeSettingObj:l}),(0,e.createElement)(r.WideLine,null),"static_page"===o.redirect_type&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(p,{settings:o,onChangeSettingObj:l}),(0,e.createElement)(r.WideLine,null)),"custom_url"===o.redirect_type&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(g,{settings:o,onChangeSettingObj:l}),(0,e.createElement)(r.WideLine,null)),(0,e.createElement)(h,{settings:o,onChangeSettingObj:l}),(0,e.createElement)(r.WideLine,null),(0,e.createElement)(w,{settings:o,onChangeSettingObj:l}))},icon:f,docHref:"https://jetformbuilder.com/features/redirect-to-page/",validators:[({settings:e})=>!e?.redirect_type&&{type:"empty",property:"redirect_type"},({settings:e})=>"static_page"===e?.redirect_type&&!e?.redirect_page&&{type:"empty",property:"redirect_page"},({settings:e})=>"custom_url"===e?.redirect_type&&!e?.redirect_url&&{type:"empty",property:"redirect_url"}],redirectTypes:[{value:"static_page",label:(0,n.__)("Static Page","jet-form-builder")},{value:"custom_url",label:(0,n.__)("Custom URL","jet-form-builder")},{value:"current_page",label:(0,n.__)("Current Page","jet-form-builder")},{value:"inserted_post",label:(0,n.__)("Inserted/Updated post","jet-form-builder"),isSupported:({fields:e})=>e.some((({value:e})=>"inserted_post_id"===e))}]};(0,a.registerAction)(C)})();