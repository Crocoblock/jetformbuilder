(()=>{"use strict";function e(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,l,a,i=[],m=!0,c=!1;try{if(l=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;m=!1}else for(;!(m=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);m=!0);}catch(e){c=!0,o=e}finally{try{if(!m&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return i}}(e,r)||function(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var r=wp.components,n=r.Modal,o=r.TextareaControl,l=r.Button,a=r.Notice,i=r.ExternalLink,m=r.Flex,c=wp.element.useState,u=wp.i18n.__,p=wp.apiFetch,f=JetFormBuilderParser,s=f.parseHTMLtoBlocks,d=f.getFormInnerFields,h=["#fake-ai","Registration form with minimum inputs","Opt-in form with gender selector like radio","Quiz form with 5 questions with choices about math"];const w=function(t){var r=t.setShowModal,f=t.footer,w=void 0===f?function(){return"Here may be buttons"}:f,b=e(c(""),2),y=b[0],g=b[1],v=e(c(""),2),E=v[0],j=v[1],S=e(c(!1),2),k=S[0],A=S[1],B=e(c(""),2),C=B[0],F=B[1];return wp.element.createElement(n,{style:{width:"60vw"},onRequestClose:function(){return r(!1)},title:wp.element.createElement(m,null,u("Generate Form with AI","jet-form-builder"),wp.element.createElement("span",{className:"badge"},u("Beta. Limited 5 requests per month","jet-form-builder"))),className:"jfb-ai-modal"},C&&wp.element.createElement(a,{status:"error",onRemove:function(){return F("")}},wp.element.createElement(m,{direction:"column"},C,wp.element.createElement(i,{href:"https://support.crocoblock.com/support/home/"},u("Contact Crocoblock support","jet-form-builder")))),Boolean(E.length)?wp.element.createElement(React.Fragment,null,wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:E},style:{padding:"2em 1em",backgroundColor:"#f6f7f7",marginBottom:"1em"}}),wp.element.createElement(w,{clearHTML:function(){return j("")},formHTML:E,prompt:y})):wp.element.createElement(React.Fragment,null,wp.element.createElement(o,{label:u("Describe the form you want","jet-form-builder"),value:y,onChange:g,help:u("Prompt example: Simple contact form","jet-form-builder")}),Boolean(y.length)&&wp.element.createElement(l,{variant:"primary",isBusy:k,disabled:k,onClick:function(){A(!0),p({path:"/jet-form-builder/v1/ai/generate",method:"POST",data:{prompt:y}}).then((function(e){F(""),j(d(e.form)),console.group(u("JFB: Parsed blocks from generated HTML","jet-form-builder")),console.log(s(e.form)),console.groupEnd()})).catch((function(e){var t;F(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:u("Undefined error.","jet-form-builder"))})).finally((function(){A(!1)}))}},u("Generate","jet-form-builder")),wp.element.createElement("h4",null,u("Tips to write good prompt:","jet-form-builder")),wp.element.createElement("ul",{style:{listStyle:"disc",paddingInlineStart:"1em"}},wp.element.createElement("li",null,u("Start with the main purpose of the form.","jet-form-builder")),wp.element.createElement("li",null,u("If you need some specific fields - describe \nthem also in prompt.","jet-form-builder")),wp.element.createElement("li",null,u("Better to use English language for \nthe prompt - AI understand it better than other","jet-form-builder"))),wp.element.createElement("h4",null,u("Examples of the good prompts:","jet-form-builder")),wp.element.createElement("ul",{style:{listStyle:"disc",paddingInlineStart:"1em"}},h.map((function(e){return wp.element.createElement("li",{key:e},wp.element.createElement(l,{onClick:function(){return g(e)},variant:"link"},e))})))))};function b(e){var t=e.name,r=e.attributes,n=JSON.stringify(r);return"\x3c!-- wp:".concat(t," ").concat(n," /--\x3e")}const y=function(e){return e.map(b).join("\n\n")};var g=wp.components,v=g.Flex,E=g.Button,j=wp.i18n.__,S=wp.apiFetch,k=JetFormBuilderParser.parseHTMLtoBlocks;const A=function(e){var t=e.clearHTML,r=e.formHTML,n=e.prompt;return wp.element.createElement(v,{justify:"flex-start"},wp.element.createElement(E,{variant:"primary",onClick:function(){var e=k(r);e.length?S({method:"POST",path:"/wp/v2/jet-form-builder",data:{title:n,content:y(e),status:"publish"}}).then((function(e){var t,r;window.location.href=(t=e.id,(r=new URL(JetFormBuilderAdmin.edit_url)).searchParams.set("post",t),r.href)})).catch(console.error):console.error(j("JFB: Invalid html","jet-form-builder"),r)}},j("Create form with this template","jet-form-builder")),wp.element.createElement(E,{variant:"secondary",onClick:t},j("Change generation prompt","jet-form-builder")))};function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var C=wp.element.useState,F=wp.i18n.__;const I=function(){var e,t,r=(e=C(!1),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,l,a,i=[],m=!0,c=!1;try{if(l=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;m=!1}else for(;!(m=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);m=!0);}catch(e){c=!0,o=e}finally{try{if(!m&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?B(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=r[0],o=r[1];return wp.element.createElement(React.Fragment,null,wp.element.createElement("a",{href:"#",className:"page-title-action",onClick:function(e){e.preventDefault(),o((function(e){return!e}))}},F("Generate with AI","jet-form-builder")),n&&wp.element.createElement(w,{setShowModal:o,footer:A}))};var T=wp.element.createRoot;wp.domReady((function(){var e=document.createElement("div");e.style.display="inline-flex",document.querySelector('.page-title-action[href*="post-new.php"]').after(e),T(e).render(wp.element.createElement(I,null))}))})();